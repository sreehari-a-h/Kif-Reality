<script>
    // Enhanced Real-time Calculator System with Editable Inputs
    document.addEventListener('DOMContentLoaded', function () {
        // Mortgage Calculator Elements
        const mortgageElements = {
            // Sliders
            propertyPrice: document.getElementById('property-price'),
            downPayment: document.getElementById('down-payment'),
            loanAmount: document.getElementById('loan-amount'),
            loanPeriod: document.getElementById('loan-period'),
            interestRate: document.getElementById('interest-rate'),

            // Editable Inputs
            propertyPriceInput: document.getElementById('property-price-input'),
            downPaymentInput: document.getElementById('down-payment-input'),
            loanAmountInput: document.getElementById('loan-amount-input'),
            loanPeriodInput: document.getElementById('loan-period-input'),
            interestRateInput: document.getElementById('interest-rate-input'),

            // Displays
            downPercentage: document.getElementById('down-percentage'),
            loanPercentage: document.getElementById('loan-percentage'),
            displayRate: document.getElementById('display-rate'),
            monthlyPayment: document.getElementById('monthly-payment')
        };

        // ROI Calculator Elements
        const roiElements = {
            // Sliders
            purchasePrice: document.getElementById('purchase-price'),
            currentValue: document.getElementById('current-value'),
            annualRent: document.getElementById('annual-rent'),
            annualExpenses: document.getElementById('annual-expenses'),
            holdingPeriod: document.getElementById('holding-period'),

            // Editable Inputs
            purchasePriceInput: document.getElementById('purchase-price-input'),
            currentValueInput: document.getElementById('current-value-input'),
            annualRentInput: document.getElementById('annual-rent-input'),
            annualExpensesInput: document.getElementById('annual-expenses-input'),
            holdingPeriodInput: document.getElementById('holding-period-input'),

            // Displays
            totalROIDisplay: document.getElementById('total-roi-display'),
            annualROIDisplay: document.getElementById('annual-roi-display')
        };

        // Residency status buttons
        const statusButtons = document.querySelectorAll('.status-btn');

        // Utility Functions
        function formatNumber(num) {
            return new Intl.NumberFormat('en-AE').format(Math.round(num));
        }

        function formatCurrency(num) {
            return new Intl.NumberFormat('en-AE').format(Math.round(num)) + ' AED';
        }

        function formatPercent(num) {
            return num.toFixed(2) + '%';
        }

        function parseFormattedNumber(str) {
            return parseFloat(str.toString().replace(/,/g, ''));
        }

        // MORTGAGE CALCULATOR FUNCTIONS
        function updateMortgageCalculations() {
            const price = parseFloat(mortgageElements.propertyPrice.value);
            const down = parseFloat(mortgageElements.downPayment.value);
            const loan = parseFloat(mortgageElements.loanAmount.value);
            const period = parseFloat(mortgageElements.loanPeriod.value);
            const rate = parseFloat(mortgageElements.interestRate.value);

            // Update input fields
            mortgageElements.loanAmount.value = loan;
            mortgageElements.downPayment.max = price * 0.8;
            mortgageElements.loanAmount.min = price * 0.2;
            mortgageElements.loanAmount.max = price * 0.8;
        }

        // ROI CALCULATOR FUNCTIONS
        function updateROICalculations() {
            const purchasePrice = parseFloat(roiElements.purchasePrice.value);
            const currentValue = parseFloat(roiElements.currentValue.value);
            const annualRent = parseFloat(roiElements.annualRent.value);
            const annualExpenses = parseFloat(roiElements.annualExpenses.value);
            const holdingPeriod = parseFloat(roiElements.holdingPeriod.value);

            // Update input fields
            roiElements.purchasePriceInput.value = formatNumber(purchasePrice);
            roiElements.currentValueInput.value = formatNumber(currentValue);
            roiElements.annualRentInput.value = formatNumber(annualRent);
            roiElements.annualExpensesInput.value = formatNumber(annualExpenses);
            roiElements.holdingPeriodInput.value = holdingPeriod;

            // Calculate ROI
            const capitalAppreciation = currentValue - purchasePrice;
            const netAnnualRent = annualRent - annualExpenses;
            const totalRentalIncome = netAnnualRent * holdingPeriod;

            const totalROI = ((capitalAppreciation + totalRentalIncome) / purchasePrice) * 100;
            const annualROI = totalROI / holdingPeriod;

            roiElements.totalROIDisplay.textContent = formatPercent(totalROI);
            roiElements.annualROIDisplay.textContent = formatPercent(annualROI);
        }

        // INPUT FIELD EVENT LISTENERS
        function setupInputListeners() {
            // Mortgage Calculator Inputs
            mortgageElements.propertyPriceInput.addEventListener('input', function () {
                const value = parseFormattedNumber(this.value);
                if (value >= 100000 && value <= 100000000) {
                    mortgageElements.propertyPrice.value = value;
                    mortgageElements.downPayment.min = value * 0.2;
                    mortgageElements.downPayment.max = value * 0.8;

                    const currentDownPercent = parseFloat(mortgageElements.downPayment.value) / value;
                    if (currentDownPercent < 0.2 || currentDownPercent > 0.8) {
                        mortgageElements.downPayment.value = value * 0.2;
                    }

                    syncMortgageSliders();
                    updateMortgageCalculations();
                }
            });

            mortgageElements.downPaymentInput.addEventListener('input', function () {
                const value = parseFormattedNumber(this.value);
                const price = parseFloat(mortgageElements.propertyPrice.value);
                if (value >= price * 0.2 && value <= price * 0.8) {
                    mortgageElements.downPayment.value = value;
                    syncMortgageSliders();
                    updateMortgageCalculations();
                }
            });

            mortgageElements.loanAmountInput.addEventListener('input', function () {
                const value = parseFormattedNumber(this.value);
                const price = parseFloat(mortgageElements.propertyPrice.value);
                if (value >= price * 0.2 && value <= price * 0.8) {
                    mortgageElements.loanAmount.value = value;
                    mortgageElements.downPayment.value = price - value;
                    updateMortgageCalculations();
                }
            });

            mortgageElements.loanPeriodInput.addEventListener('input', function () {
                const value = parseFloat(this.value);
                if (value >= 1 && value <= 25) {
                    mortgageElements.loanPeriod.value = value;
                    updateMortgageCalculations();
                }
            });

            mortgageElements.interestRateInput.addEventListener('input', function () {
                const value = parseFloat(this.value);
                if (value >= 1 && value <= 10) {
                    mortgageElements.interestRate.value = value;
                    updateMortgageCalculations();
                }
            });

            // ROI Calculator Inputs
            roiElements.purchasePriceInput.addEventListener('input', function () {
                const value = parseFormattedNumber(this.value);
                if (value >= 500000 && value <= 10000000) {
                    roiElements.purchasePrice.value = value;
                    updateROICalculations();
                }
            });

            roiElements.currentValueInput.addEventListener('input', function () {
                const value = parseFormattedNumber(this.value);
                if (value >= 500000 && value <= 12000000) {
                    roiElements.currentValue.value = value;
                    updateROICalculations();
                }
            });

            roiElements.annualRentInput.addEventListener('input', function () {
                const value = parseFormattedNumber(this.value);
                if (value >= 50000 && value <= 800000) {
                    roiElements.annualRent.value = value;
                    updateROICalculations();
                }
            });

            roiElements.annualExpensesInput.addEventListener('input', function () {
                const value = parseFormattedNumber(this.value);
                if (value >= 5000 && value <= 100000) {
                    roiElements.annualExpenses.value = value;
                    updateROICalculations();
                }
            });

            roiElements.holdingPeriodInput.addEventListener('input', function () {
                const value = parseFloat(this.value);
                if (value >= 1 && value <= 20) {
                    roiElements.holdingPeriod.value = value;
                    updateROICalculations();
                }
            });
        }

        // MORTGAGE SLIDER EVENT LISTENERS
        mortgageElements.propertyPrice.addEventListener('input', function () {
            const price = parseFloat(this.value);
            mortgageElements.downPayment.min = price * 0.2;
            mortgageElements.downPayment.max = price * 0.8;

            const currentDownPercent = parseFloat(mortgageElements.downPayment.value) / parseFloat(mortgageElements.propertyPrice.value);
            mortgageElements.downPayment.value = Math.max(mortgageElements.downPayment.min, Math.min(mortgageElements.downPayment.max, price * currentDownPercent));

            syncMortgageSliders();
            updateMortgageCalculations();
        });

        mortgageElements.downPayment.addEventListener('input', function () {
            syncMortgageSliders();
            updateMortgageCalculations();
        });

        mortgageElements.loanAmount.addEventListener('input', function () {
            const price = parseFloat(mortgageElements.propertyPrice.value);
            const loan = parseFloat(this.value);
            const down = price - loan;
            mortgageElements.downPayment.value = down;
            updateMortgageCalculations();
        });

        mortgageElements.loanPeriod.addEventListener('input', updateMortgageCalculations);
        mortgageElements.interestRate.addEventListener('input', updateMortgageCalculations);

        // Residency status buttons
        statusButtons.forEach(button => {
            button.addEventListener('click', function () {
                statusButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');

                const rate = parseFloat(this.getAttribute('data-rate'));
                mortgageElements.interestRate.value = rate;
                updateMortgageCalculations();
            });
        });

        // ROI SLIDER EVENT LISTENERS
        roiElements.purchasePrice.addEventListener('input', updateROICalculations);
        roiElements.currentValue.addEventListener('input', updateROICalculations);
        roiElements.annualRent.addEventListener('input', updateROICalculations);
        roiElements.annualExpenses.addEventListener('input', updateROICalculations);
        roiElements.holdingPeriod.addEventListener('input', updateROICalculations);

        // Setup input listeners
        setupInputListeners();

        // Initialize both calculators
        syncMortgageSliders();
        updateMortgageCalculations();
        updateROICalculations();
    });
</script>{% extends 'base.html' %}

{% block title %}Home - KIF Realty{% endblock %}

{% load static %}

{% block extra_css %}
<style>
    /* Hero Section - OBSIDIAN Style */
    .hero {
        height: 100vh;
        min-height: 700px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        background: linear-gradient(
        rgba(2, 2, 2, 0.7), 
        rgba(2, 2, 2, 0.7)   
    );
        overflow: hidden;
        margin-top: 0;
    }

    /* .hero::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--accent-gradient);
        opacity: 0.05;
    } */

    .hero-video {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;   /* ensures full coverage */
        z-index: -2;         /* behind everything */
    }

    /* .hero-particles {
        position: absolute;
        width: 100%;
        height: 100%;
        overflow: hidden;
    } */

    .hero-badge {
        display: inline-block;
        padding: 0.5rem 1.5rem;
        background: var(--glass-bg);
        border: 1px solid var(--border-subtle);
        border-radius: 50px;
        font-size: 0.9rem;
        font-weight: 500;
        margin-bottom: 2rem;
        backdrop-filter: blur(10px);
        color: var(--bright-gold);
    }

    .hero-content-container {
        position: relative;
        z-index: 2;
        width: 100%;
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 3rem;
    }

    .hero-content {
        text-align: center;
        color: white;
    }

    .hero-content h1 {
    font-family: 'Playfair Display', serif;
    font-size: 3.8rem;
    margin-bottom: 2.5rem;
    /* background: #EFBF04; */
    background: var(--accent-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    /* letter-spacing: -0.02em; */
    /* animation: titleGlow 3s ease-in-out infinite alternate; */

    /* Add glow / shadow for readability */
    /* text-shadow: 
        2px 2px 2px #2c2c2c, 
        0 0 1px rgba(0,0,0,0.1); */
}

.hero-content p {
    font-size: 1.2rem;
    color: #fff;
    text-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
}


    .hero-subtitle {
        font-size: 1.4rem;
        margin-bottom: 1.5rem;
        /* color: var(--text-muted); */
        /* font-weight: 300; */
        line-height: 1.8;
        opacity: 0.9;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
    }

    .cta-buttons {
        display: flex;
        gap: 2.5rem;
        justify-content: center;
        flex-wrap: wrap;
        /* margin-top: 1.2rem; */
    }

    /* Services Section - OBSIDIAN Style */
    .services-section {
        background: linear-gradient(135deg, var(--charcoal-gray) 0%, var(--obsidian-black) 100%);
        position: relative;
        overflow: hidden;
        padding: 4rem 3rem;
    }

    .services-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--accent-gradient);
        opacity: 0.02;
    }

    .section-title {
        text-align: center;
        margin-bottom: 2rem;
        position: relative;
        z-index: 2;
    }

    .section-title h2 {
        font-family: 'Cormorant Garamond', serif;
        font-size: 3.5rem;
        font-weight: 400;
        color: var(--rose-gold);
        margin-top: 1rem;
        margin-bottom: 1rem;
        letter-spacing: -0.01em;
    }

    .section-title p {
        font-size: 1.2rem;
        color: var(--text-muted);
        max-width: 800px;
        margin: 0 auto;
        line-height: 1.8;
        font-weight: 300;
    }

    .services-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 1rem;
        max-width: 1400px;
        margin: 0 auto;
        position: relative;
        z-index: 2;
    }

    .service-card {
        background: linear-gradient(145deg, var(--charcoal-gray), var(--medium-gray));
        border: 1px solid rgba(232, 180, 160, 0.1);
        border-radius: 25px;
        padding: 1rem;
        text-align: center;
        transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
        backdrop-filter: blur(10px);
    }

    .service-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--accent-gradient);
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    .service-card:hover::before {
        opacity: 0.05;
    }

    .service-card:hover {
        transform: translateY(-15px) scale(1.02);
        box-shadow: 0 30px 60px rgba(0, 0, 0, 0.4);
        border-color: rgba(232, 180, 160, 0.3);
    }

    .service-content {
        position: relative;
        z-index: 1;
    }

    .service-icon {
        width: 80px;
        height: 80px;
        margin: 0 auto 2rem;
        background: var(--accent-gradient);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.4s ease;
    }

    .service-icon i {
        font-size: 2.2rem;
        color: var(--obsidian-black);
        transition: all 0.4s ease;
    }

    .service-card:hover .service-icon {
        transform: scale(1.15) rotate(5deg);
        box-shadow: 0 15px 30px rgba(232, 180, 160, 0.4);
    }

    .service-card h3 {
        font-family: 'Cormorant Garamond', serif;
        font-size: 1.8rem;
        font-weight: 600;
        color: var(--text-light);
        margin-bottom: 1.5rem;
        letter-spacing: -0.01em;
    }

    .service-card p {
        color: var(--text-muted);
        line-height: 1.7;
        font-weight: 300;
    }

    /* Locations Section - OBSIDIAN Style */
    .locations-section {
        padding: 4rem 3rem;
        position: relative;
        background: var(--obsidian-black);
        overflow: hidden;
    }

    .locations-bg {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(circle at 30% 70%, rgba(232, 180, 160, 0.08) 0%, transparent 50%),
            radial-gradient(circle at 70% 30%, rgba(244, 208, 63, 0.06) 0%, transparent 50%);
    }

    .locations-content {
        position: relative;
        z-index: 2;
        max-width: 1400px;
        margin: 0 auto;
    }

    .locations-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.2rem;
        margin-top: 4rem;
    }

    .location-item {
        background: linear-gradient(145deg, var(--charcoal-gray), var(--medium-gray));
        padding: 2.5rem 2rem;
        border-radius: 20px;
        text-align: center;
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        border: 1px solid rgba(232, 180, 160, 0.1);
        position: relative;
        overflow: hidden;
    }

    .location-item::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--accent-gradient);
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    .location-item:hover::before {
        opacity: 0.05;
    }

    .location-item:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        border-color: rgba(232, 180, 160, 0.3);
    }

    .location-icon {
        width: 60px;
        height: 60px;
        margin: 0 auto 1.5rem;
        background: var(--accent-gradient);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        z-index: 1;
        transition: all 0.4s ease;
    }

    .location-icon i {
        font-size: 1.6rem;
        color: var(--obsidian-black);
    }

    .location-item:hover .location-icon {
        transform: scale(1.1) rotate(10deg);
    }

    .location-item h3 {
        font-family: 'Cormorant Garamond', serif;
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--text-light);
        margin-bottom: 0.8rem;
        position: relative;
        z-index: 1;
    }

    .location-item p {
        color: var(--text-muted);
        font-size: 0.95rem;
        position: relative;
        z-index: 1;
        font-weight: 300;
    }

    /* Why Choose Section - OBSIDIAN Style */
    .why-choose-section {
        padding: 4rem 3rem;
        background: linear-gradient(135deg, var(--medium-gray) 0%, var(--charcoal-gray) 100%);
        position: relative;
        overflow: hidden;
    }

    .why-choose-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--accent-gradient);
        opacity: 0.02;
    }

    .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 1.2rem;
        max-width: 1200px;
        margin: 4rem auto 0;
        position: relative;
        z-index: 2;
    }

    .feature-card {
        background: linear-gradient(145deg, var(--charcoal-gray), var(--medium-gray));
        padding: 1.5rem 1.5rem;
        border-radius: 25px;
        text-align: center;
        border: 1px solid rgba(232, 180, 160, 0.1);
        transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
    }

    .feature-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--accent-gradient);
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    .feature-card:hover::before {
        opacity: 0.05;
    }

    .feature-card:hover {
        transform: translateY(-15px) scale(1.02);
        box-shadow: 0 30px 60px rgba(0, 0, 0, 0.4);
        border-color: rgba(232, 180, 160, 0.3);
    }

    .feature-number {
        font-family: 'Cormorant Garamond', serif;
        font-size: 4rem;
        font-weight: 600;
        background: var(--accent-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        display: block;
        margin-bottom: 1.5rem;
        position: relative;
        z-index: 1;
    }

    .feature-card h3 {
        font-family: 'Cormorant Garamond', serif;
        font-size: 1.6rem;
        font-weight: 600;
        color: var(--text-light);
        margin-bottom: 1.5rem;
        position: relative;
        z-index: 1;
    }

    .feature-card p {
        color: var(--text-muted);
        line-height: 1.7;
        font-weight: 300;
        position: relative;
        z-index: 1;
    }

    /* Calculator Container - Dark Theme Design */
    .calculators-section {
        padding: 3rem 2rem;
        background: linear-gradient(135deg, #1a1a1a 0%, #0f1419 100%);
        position: relative;
        overflow: hidden;
        min-height: 100vh;
    }

    .calculators-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, #f4d03f, #e8b4a0);
        opacity: 0.02;
    }

    .section-title {
        text-align: center;
        margin-bottom: 3rem;
        position: relative;
        z-index: 2;
    }

    .section-title h2 {
        font-family: 'Playfair Display', serif;
        font-size: 2.8rem;
        font-weight: 400;
        color: #e8b4a0;
        margin: 0 0 1rem 0;
        letter-spacing: -0.01em;
    }

    .section-title p {
        color: rgba(255, 255, 255, 0.75);
        line-height: 1.5;
        font-weight: 300;
        font-size: 1rem;
        max-width: 700px;
        margin: 0 auto;
    }

    .calculator-container {
        max-width: auto;
        /* margin: 0 auto 3rem; */
        position: relative;
        z-index: 2;
    }

    .calculator-card {
        background: linear-gradient(145deg, #1a1a1a, #2a2a2a);
        border: 1px solid rgba(232, 180, 160, 0.1);
        border-radius: 20px;
        padding: 2rem;
        transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        backdrop-filter: blur(10px);
        box-sizing: border-box;
    }

    .calculator-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, #f4d03f, #e8b4a0);
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    .calculator-card:hover::before {
        opacity: 0.03;
    }

    .calculator-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        border-color: rgba(232, 180, 160, 0.3);
    }

    .calculator-header {
        text-align: center;
        margin-bottom: 2rem;
        position: relative;
        z-index: 1;
    }

    .calculator-header h3 {
        font-family: 'Playfair Display', serif;
        font-size: 1.8rem;
        font-weight: 600;
        color: #ffffff;
        margin: 0 0 0.8rem 0;
        letter-spacing: -0.01em;
    }

    .calculator-header p {
        color: rgba(255, 255, 255, 0.75);
        line-height: 1.4;
        font-weight: 300;
        font-size: 0.95rem;
    }

    .result-display {
        display: flex;
        flex-direction: column;
        /* justify-content: space-between; */
        justify-content: center;
        gap: 3.5rem;
        align-items: center;
        margin-bottom: 1.5rem;
        padding: 2rem;
        background: linear-gradient(145deg, #0f1419, #1a1a1a);
        border-radius: 15px;
        border: 1px solid rgba(232, 180, 160, 0.2);
        position: relative;
        z-index: 1;
    }

    .result-main,
    .result-secondary {
        text-align: center;
    }

    .result-label-small {
        font-family: 'Playfair Display', serif;
        font-size: 1.25rem;
        font-weight: 400;
        color: rgba(255, 255, 255, 0.75);
        display: block;
        margin-bottom: 0.5rem;
        /* text-transform: lowercase; */
    }

    .result-value-large {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        font-size: 3rem;
        font-weight: 700;
        color: #e8b4a0;
        line-height: 1.1;
        text-shadow: 0 2px 8px rgba(232, 180, 160, 0.3);
    }

    .result-value-medium {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        font-size: 2.2rem;
        font-weight: 600;
        color: #e8b4a0;
        line-height: 1.1;
        text-shadow: 0 1px 5px rgba(232, 180, 160, 0.2);
    }

    .calculator-form {
        position: relative;
        z-index: 1;
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        margin-bottom: 2rem;
    }

    .form-group {
        display: flex;
        flex-direction: column;
    }

    .calculator-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 1rem;
    }

    .calculator-right {
        display: grid;
        grid-template-columns: 1fr;
    }

    .calculator-left {
        display: grid;
        grid-template-columns: 1fr;
    }

    .form-group label {
        font-family: 'Playfair Display', serif;
        font-size: 1.1rem;
        font-weight: 500;
        color: #ffffff;
        margin-bottom: 0.8rem;
    }

    .input-slider-group {
        position: relative;
    }

    .editable-input {
        width: 100%;
        padding: 1rem 1.2rem;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, monospace;
        font-size: 1.1rem;
        font-weight: 600;
        color: #ffffff;
        background: linear-gradient(145deg, #0f1419, #1a1a1a);
        border: 2px solid rgba(232, 180, 160, 0.2);
        border-radius: 10px;
        outline: none;
        transition: all 0.3s ease;
        text-align: center;
        margin-bottom: 0.8rem;
        box-sizing: border-box;
    }

    .editable-input:focus {
        border-color: #e8b4a0;
        box-shadow: 0 0 0 3px rgba(232, 180, 160, 0.1);
    }

    .button-group {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        border-radius: 12px;
        overflow: hidden;
        border: 1px solid rgba(232, 180, 160, 0.2);
        background: linear-gradient(145deg, #0f1419, #1a1a1a);
        margin-top: 0.8rem;
    }

    .status-btn {
        padding: 1rem;
        border: none;
        background: transparent;
        font-family: 'Playfair Display', serif;
        font-size: 0.9rem;
        font-weight: 400;
        color: rgba(255, 255, 255, 0.75);
        cursor: pointer;
        transition: all 0.3s ease;
        border-right: 1px solid rgba(232, 180, 160, 0.2);
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 0.3rem;
    }

    .status-btn:last-child {
        border-right: none;
    }

    .status-btn .rate-badge {
        font-size: 0.75rem;
        font-weight: 600;
        color: #f4d03f;
        opacity: 0.9;
    }

    .status-btn.active {
        background: linear-gradient(135deg, #f4d03f, #e8b4a0);
        color: #0f1419;
        font-weight: 600;
    }

    .status-btn.active .rate-badge {
        color: #0f1419;
        opacity: 1;
    }

    .status-btn:not(.active):hover {
        background: rgba(232, 180, 160, 0.1);
        color: #ffffff;
    }

    .slider {
        appearance: none;
        -webkit-appearance: none;
        width: 100%;
        height: 8px;
        border-radius: 4px;
        background: linear-gradient(90deg, #0f1419, #1a1a1a);
        outline: none;
        cursor: pointer;
        margin: 0.8rem 0;
        border: 1px solid rgba(232, 180, 160, 0.2);
    }

    .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background: linear-gradient(135deg, #f4d03f, #e8b4a0);
        cursor: pointer;
        border: 2px solid #0f1419;
        box-shadow: 0 3px 8px rgba(232, 180, 160, 0.4);
        transition: all 0.3s ease;
    }

    .slider::-webkit-slider-thumb:hover {
        transform: scale(1.15);
        box-shadow: 0 4px 12px rgba(232, 180, 160, 0.6);
    }

    .slider::-moz-range-thumb {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background: linear-gradient(135deg, #f4d03f, #e8b4a0);
        cursor: pointer;
        border: 2px solid #0f1419;
        box-shadow: 0 3px 8px rgba(232, 180, 160, 0.4);
        transition: all 0.3s ease;
    }

    .slider-values {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-family: 'Playfair Display', serif;
        font-size: 0.85rem;
        color: rgba(255, 255, 255, 0.75);
    }

    .percentage-value {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        font-weight: 600;
        color: #e8b4a0;
        font-size: 0.95rem;
    }

    .upfront-costs-section {
        margin: 2rem 0;
        text-align: center;
    }

    .btn-upfront-costs {
        background: linear-gradient(135deg, #f4d03f, #e8b4a0);
        color: #0f1419;
        border: none;
        padding: 1rem 2rem;
        border-radius: 25px;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        font-size: 0.95rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.6rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        box-shadow: 0 4px 15px rgba(244, 208, 63, 0.3);
    }

    .btn-upfront-costs:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(244, 208, 63, 0.4);
    }

    .btn-upfront-costs:active {
        transform: translateY(0);
        box-shadow: 0 2px 10px rgba(244, 208, 63, 0.3);
    }

    .btn-upfront-costs i {
        font-size: 0.9rem;
    }

    /* Additional fees breakdown */
    .fees-breakdown {
        margin-top: 2rem;
        padding: 1.5rem;
        background: linear-gradient(145deg, #0f1419, #1a1a1a);
        border-radius: 15px;
        border: 1px solid rgba(232, 180, 160, 0.2);
        display: none;
    }

    .fees-breakdown.show {
        display: block;
    }

    .fees-breakdown h4 {
        color: #e8b4a0;
        margin-bottom: 1rem;
        font-family: 'Playfair Display', serif;
        font-size: 1.2rem;
    }

    .fee-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.5rem 0;
        border-bottom: 1px solid rgba(232, 180, 160, 0.1);
    }

    .fee-item:last-child {
        border-bottom: none;
        font-weight: 600;
        color: #e8b4a0;
        margin-top: 0.5rem;
        padding-top: 1rem;
        /* border-top: 1px solid rgba(232, 180, 160, 0.2); */
    }

    .fee-label {
        color: rgba(255, 255, 255, 0.85);
        font-size: 0.9rem;
    }

    .fee-value {
        color: #ffffff;
        font-weight: 600;
        font-family: monospace;
    }

    @media (max-width: 768px) {
        .form-row {
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        .button-group {
            grid-template-columns: 1fr;
        }

        .status-btn {
            border-right: none;
            border-bottom: 1px solid rgba(232, 180, 160, 0.2);
            flex-direction: row;
            justify-content: space-between;
            text-align: left;
            padding: 0.8rem 1rem;
        }

        .status-btn:last-child {
            border-bottom: none;
        }

        .result-display {
            flex-direction: column;
            gap: 1.5rem;
            text-align: center;
        }

        .result-value-large {
            font-size: 2.5rem;
        }

        .result-value-medium {
            font-size: 1.8rem;
        }
    }

    @media (max-width: 480px) {
        .calculators-section {
            padding: 2rem 1rem;
        }

        .calculator-card {
            padding: 1.5rem;
        }

        .result-value-large {
            font-size: 2rem;
        }

        .result-value-medium {
            font-size: 1.5rem;
        }
    }

    /* CTA Section - OBSIDIAN Style */
    .cta-section {
        padding: 4rem 3rem;
        background: var(--obsidian-black);
        text-align: center;
        position: relative;
        overflow: hidden;
    }

    .cta-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(circle at center, rgba(232, 180, 160, 0.1) 0%, transparent 70%);
    }

    .cta-content {
        max-width: 900px;
        margin: 0 auto;
        position: relative;
        z-index: 2;
    }

    .cta-content h2 {
        font-family: 'Cormorant Garamond', serif;
        font-size: 3.5rem;
        font-weight: 400;
        color: var(--text-light);
        margin-bottom: 2rem;
        line-height: 1.2;
        letter-spacing: -0.01em;
    }

    .cta-content p {
        font-size: 1.2rem;
        color: var(--text-muted);
        line-height: 1.8;
        margin-bottom: 2rem;
        font-weight: 300;
    }

    .btn-primary-custom {
        background: var(--accent-gradient);
        color: white;
        padding: 1rem 1.2rem;
        border-radius: 50px;
        text-decoration: none;
        font-weight: 700;
        font-size: 0.9rem;
        display: inline-block;
        transition: all 0.4s ease;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        position: relative;
        overflow: hidden;
        margin-right: 2rem;
    }

    .btn-primary-custom::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.6s;
    }

    .btn-primary-custom:hover::before {
        left: 100%;
    }

    .btn-primary-custom:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 45px rgba(232, 180, 160, 0.6);
        color: white;
    }

    .btn-secondary{
            color:white
        }

    .btn-secondary-custom {
        background: transparent;
        color: var(--rose-gold);
        padding: 1rem 1.2rem;
        border: 2px solid var(--rose-gold);
        border-radius: 50px;
        text-decoration: none;
        font-weight: 600;
        font-size: 0.9rem;
        display: inline-block;
        transition: all 0.4s ease;
        text-transform: uppercase;
        letter-spacing: 0.1em;
    }

    .btn-secondary-custom:hover {
        background: var(--rose-gold);
        color: var(--obsidian-black);
        transform: translateY(-4px);
        box-shadow: 0 15px 35px rgba(232, 180, 160, 0.4);
    }

    /* Enhanced animations */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-in {
        animation: fadeInUp 0.8s ease forwards;
    }

    /* Loading animations */
    .services-grid .service-card {
        opacity: 0;
        transform: translateY(30px);
        animation: fadeInUp 0.8s ease forwards;
    }

    .services-grid .service-card:nth-child(1) {
        animation-delay: 0.1s;
    }

    .services-grid .service-card:nth-child(2) {
        animation-delay: 0.2s;
    }

    .services-grid .service-card:nth-child(3) {
        animation-delay: 0.3s;
    }

    .services-grid .service-card:nth-child(4) {
        animation-delay: 0.4s;
    }

    .services-grid .service-card:nth-child(5) {
        animation-delay: 0.5s;
    }

    .services-grid .service-card:nth-child(6) {
        animation-delay: 0.6s;
    }

    /* Mobile responsive design */
    @media (max-width: 1200px) {
        .calculators-container {
            grid-template-columns: 1fr;
            max-width: 800px;
        }
    }

    /* Responsive override for mobile/tablet */
    @media (max-width: 991px) {
        .calculator-card {
            flex-direction: column;
            max-height: none;
            height: auto;
        }

        .calculator-left,
        .calculator-right {
            max-height: none;
            height: auto;
            padding: 1.2rem;
            border-radius: 0;
        }

        .calculator-right {
            border-left: none;
            /* border-top: 1px solid rgba(232, 180, 160, 0.2); */
        }
    }


    @media (max-width: 992px) {
        .hero-content h1 {
            font-size: 2.5rem;
        }

        .section-title h2 {
            font-size: 3rem;
        }

        .services-grid {
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        .locations-grid {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        .features-grid {
            grid-template-columns: 1fr;
        }

        .calculators-container {
            grid-template-columns: 1fr;
            gap: 2rem;
            max-width: 700px;
        }

        .calculator-card {
            height: 800px;
            max-height: 800px;
        }

        .calculator-left,
        .calculator-right {
            height: 100%;
            max-height: 800px;
            overflow-y: auto;
        }
    }

    @media (max-width: 768px) {
        .hero {
            height: 80vh;
            min-height: 500px;
            padding: 2rem 0;
            margin-top: 80px;
        }

        .hero-content-container {
            margin-top: 2%;
            padding: 0 1.5rem;
        }

        .hero-content h1 {
            font-size: 2.8rem;
        }

        .hero-subtitle {
            font-size: 1.2rem;
        }

        .section-title h2 {
            font-size: 2.5rem;
        }

        .services-section,
        .locations-section,
        .why-choose-section,
        .cta-section,
        .calculators-section {
            padding: 3rem 1rem;
        }

        .cta-buttons {
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }

        .btn-primary-custom,
        .btn-secondary-custom {
            width: 100%;
            max-width: 300px;
            margin-right: 0;
            margin-bottom: 1rem;
        }

        .cta-content h2 {
            font-size: 2.5rem;
        }

        /* Calculator mobile styles */
        .calculators-container {
            max-width: 100%;
            margin: 1.5rem auto 0;
            padding: 0 1rem;
            gap: 1.5rem;
        }

        .calculator-card {
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .calculator-header h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .calculator-header p {
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .result-display {
            flex-direction: column;
            gap: 1rem;
            padding: 1.25rem;
            text-align: center;
        }

        .result-value-large {
            font-size: 1.8rem;
        }

        .result-value-medium {
            font-size: 1.2rem;
        }

        .button-group {
            flex-direction: column;
        }

        .status-btn {
            border-right: none;
            border-bottom: 1px solid rgba(232, 180, 160, 0.2);
            padding: 0.8rem 1rem;
        }

        .status-btn:last-child {
            border-bottom: none;
        }

        .slider-values {
            font-size: 0.75rem;
        }

        .current-value,
        .percentage-value {
            font-size: 0.8rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }
    }

    @media (max-width: 480px) {
        .hero-content h1 {
            font-size: 2.2rem;
        }

        .section-title h2 {
            font-size: 2rem;
        }

        .service-card,
        .feature-card {
            padding: 2rem 1.5rem;
        }

        .cta-content h2 {
            font-size: 2rem;
        }

        .calculators-section {
            padding: 2rem 0.5rem;
        }

        .calculator-card {
            padding: 1.2rem;
            margin: 0 0.5rem;
        }

        .calculator-header h3 {
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
        }

        .calculator-header p {
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .result-display {
            padding: 1rem;
            gap: 0.8rem;
        }

        .result-value-large {
            font-size: 2rem;
        }

        .result-value-medium {
            font-size: 1.4rem;
        }

        .result-label-small {
            font-size: 0.9rem;
        }

        .form-group label {
            font-size: 0.95rem;
        }

        .slider-values {
            font-size: 0.8rem;
        }

        .current-value,
        .percentage-value {
            font-size: 0.85rem;
        }

        .status-btn {
            font-size: 0.9rem;
            padding: 0.7rem 0.8rem;
        }
    }

    @media (max-width: 360px) {
        .hero-content h1 {
            font-size: 2rem;
        }

        .section-title h2 {
            font-size: 1.8rem;
        }

        .calculators-section {
            padding: 1.5rem 0.25rem;
        }

        .calculator-card {
            padding: 1rem;
            margin: 0 0.25rem;
        }

        .calculator-header h3 {
            font-size: 1.2rem;
            margin-bottom: 0.6rem;
        }

        .calculator-header p {
            font-size: 0.8rem;
            line-height: 1.3;
        }

        .result-display {
            padding: 0.8rem;
            gap: 0.6rem;
        }

        .result-value-large {
            font-size: 1.8rem;
        }

        .result-value-medium {
            font-size: 1.2rem;
        }

        .result-label-small {
            font-size: 0.85rem;
        }

        .form-group label {
            font-size: 0.9rem;
        }

        .slider-values {
            font-size: 0.75rem;
        }

        .current-value,
        .percentage-value {
            font-size: 0.8rem;
        }

        .status-btn {
            font-size: 0.85rem;
            padding: 0.6rem 0.7rem;
        }
    }
    @media (max-width: 768px) {
    /* Stack the calculator sections vertically */
    .calculator-card {
        padding: 1rem;
        max-height: none;
        height: auto;
        box-sizing: border-box;
        margin-bottom: 1rem;
    }
    .calculator-grid {
        display: block; /* instead of grid or flex, this stacks left/right */
        gap: 0;
    }
    .calculator-left,
    .calculator-right {
        display: block;
        width: 100%;
        padding: 0;
        border-radius: 0;
        height: auto;
        max-height: none;
        overflow: visible;
    }
    .calculator-header {
        text-align: left;
        margin-bottom: 1rem;
    }
    .result-display {
        flex-direction: column !important;
        align-items: center;
        text-align: left;
        padding: 1rem;
        gap: 1rem;
        margin-bottom: 1.2rem;
    }
    .result-label-small {
        font-size: 1rem;
        margin-bottom: 0.4rem;
    }
    .result-value-large {
        font-size: 1.5rem;
    }
    .result-value-medium {
        font-size: 1.2rem;
    }
    .form-row {
        grid-template-columns: 1fr;
        gap: 1rem;
        margin-bottom: 1.5rem;
    }
    .form-group {
        margin-bottom: 1rem;
    }
    .slider-values {
        font-size: 0.85rem;
        flex-direction: row;
        align-items: flex-start;
    }
    .editable-input {
        font-size: 1rem;
        padding: 0.8rem 1rem;
        margin-bottom: 0.5rem;
    }
    .slider {
        height: 6px;
        margin: 0.5rem 0;
    }
    .button-group {
        grid-template-columns: 1fr;
        gap: 0.5rem;
    }
    .status-btn {
        padding: 0.7rem 0.7rem;
        font-size: 0.95rem;
        border-right: none;
        border-bottom: 1px solid rgba(232, 180, 160, 0.18);
        flex-direction: row;
        justify-content: space-between;
        text-align: left;
        gap: 0.3rem;
    }
    .status-btn:last-child {
        border-bottom: none;
    }
}

</style>
{% endblock %}

{% load custom_filters %}

{% block content %}

<!-- Hero Section -->
<section id="home" class="hero">
    <!-- Background Video -->
    <video autoplay muted loop playsinline class="hero-video">
        <source src="https://kifrealty.s3.us-east-1.amazonaws.com/kif_web.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <!-- Optional particle overlay -->
    <div class="hero-particles"></div>

    <!-- Hero Content -->
    <div class="hero-content-container">
        <div class="hero-content">
            <div class="hero-badge">
                <i class="fas fa-star"></i>
                Dubai's Premier Real Estate Partner
            </div>
            <h1>Property expert in Dubai, UAE</h1>
            <p class="hero-subtitle">
                Offplan | Ready to move project | Land broker | Property investment consultant |
                Super Agent for new Developers
            </p>
            <div class="cta-buttons">
                <a href="/properties" class="btn btn-primary">Explore Properties</a>
                <a href="/contact" class="btn btn-secondary">Our Services</a>
            </div>
        </div>
    </div>
</section>


<!-- Services Section -->
<section id="services" class="services-section">
    <div class="section-title">
        <h2>Comprehensive Dubai Real Estate Services</h2>
        <p>From luxury villas for sale in Dubai to off-plan properties with flexible payment plans - we provide
            end-to-end solutions for every investor, family, and business owner in the UAE property market.</p>
    </div>
    <div class="services-grid">
        <div class="service-card">
            <div class="service-content">
                <div class="service-icon">
                    <i class="fas fa-building"></i>
                </div>
                <h3>Buy Apartments in Dubai 2025</h3>
                <p>Studio apartments in JVC, luxury penthouses in Downtown Dubai, and waterfront properties in Dubai
                    Marina with expert ROI analysis and market insights.</p>
            </div>
        </div>

        <div class="service-card">
            <div class="service-content">
                <div class="service-icon">
                    <i class="fas fa-home"></i>
                </div>
                <h3>Luxury Villas & Townhouses</h3>
                <p>Beachfront villas in Palm Jumeirah, golf course homes in Dubai Hills, and affordable villas in
                    Dubailand with premium locations and exclusive communities.</p>
            </div>
        </div>

        <div class="service-card">
            <div class="service-content">
                <div class="service-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h3>Off-Plan Investment Properties</h3>
                <p>Direct from developers with flexible payment plans, high-growth communities, and guaranteed returns
                    on Dubai freehold property investments.</p>
            </div>
        </div>

        <div class="service-card">
            <div class="service-content">
                <div class="service-icon">
                    <i class="fas fa-briefcase"></i>
                </div>
                <h3>Commercial Property Dubai</h3>
                <p>Office spaces in Business Bay, retail units in prime locations, and mixed-use buildings with
                    strategic commercial plots for business growth.</p>
            </div>
        </div>

        <div class="service-card">
            <div class="service-content">
                <div class="service-icon">
                    <i class="fas fa-key"></i>
                </div>
                <h3>Property Management</h3>
                <p>End-to-end portfolio care, short-term rental management, and fully furnished properties with
                    consistent passive income generation.</p>
            </div>
        </div>

        <div class="service-card">
            <div class="service-content">
                <div class="service-icon">
                    <i class="fas fa-calculator"></i>
                </div>
                <h3>ROI Analysis & Investment Planning</h3>
                <p>Data-backed Dubai property ROI calculation, market trend analysis, and personalized investment
                    strategies for maximum returns.</p>
            </div>
        </div>
    </div>
</section>

<!-- Top Locations Section -->
<section class="locations-section">
    <div class="locations-bg"></div>
    <div class="locations-content">
        <div class="section-title">
            <h2 style="color: white;">Prime Dubai Locations We Cover</h2>
            <p style="color: rgba(255,255,255,0.9);">From iconic Downtown Dubai to emerging Dubai South - discover the
                best property investment opportunities across Dubai's most sought-after communities.</p>
        </div>
        <div class="locations-grid">
            <div class="location-item">
                <div class="location-icon"><i class="fas fa-city"></i></div>
                <h3>Downtown Dubai</h3>
                <p>Burj Khalifa views & iconic lifestyle</p>
            </div>
            <div class="location-item">
                <div class="location-icon"><i class="fas fa-water"></i></div>
                <h3>Dubai Marina</h3>
                <p>Waterfront living with nightlife & retail</p>
            </div>
            <div class="location-item">
                <div class="location-icon"><i class="fas fa-umbrella-beach"></i></div>
                <h3>Palm Jumeirah</h3>
                <p>Ultra-luxury beachfront properties</p>
            </div>
            <div class="location-item">
                <div class="location-icon"><i class="fas fa-golf-ball"></i></div>
                <h3>Dubai Hills Estate</h3>
                <p>Golf course communities & family living</p>
            </div>
            <div class="location-item">
                <div class="location-icon"><i class="fas fa-building"></i></div>
                <h3>Business Bay</h3>
                <p>Central commercial & residential hub</p>
            </div>
            <div class="location-item">
                <div class="location-icon"><i class="fas fa-plane-departure"></i></div>
                <h3>Dubai South</h3>
                <p>Future growth near Al Maktoum Airport</p>
            </div>
            <div class="location-item">
                <div class="location-icon"><i class="fas fa-home"></i></div>
                <h3>Jumeirah Village Circle</h3>
                <p>Affordable apartments & townhouses</p>
            </div>
            <div class="location-item">
                <div class="location-icon"><i class="fas fa-umbrella-beach"></i></div>
                <h3>Ras Al Khaimah</h3>
                <p>Next frontier of luxury developments</p>
            </div>
        </div>
    </div>
</section>

<!-- Why Choose Us Section -->
<section class="why-choose-section">
    <div class="section-title">
        <h2>Why Choose KIF Realty for Dubai Property Investment?</h2>
        <p>Ranked among the top real estate brokers in Dubai, we deliver transparent, reliable, and profitable property
            solutions since 2011.</p>
    </div>
    <div class="features-grid">
        <div class="feature-card">
            <span class="feature-number">13+</span>
            <h3>Years of Market Leadership</h3>
            <p>Deep expertise in Dubai real estate market dynamics, developer relationships, and investment strategies.
            </p>
        </div>
        <div class="feature-card">
            <span class="feature-number">100%</span>
            <h3>RERA Certified Team</h3>
            <p>Licensed real estate professionals ensuring compliance, transparency, and ethical business practices.</p>
        </div>
        <div class="feature-card">
            <span class="feature-number">24/7</span>
            <h3>Customer Support</h3>
            <p>Dedicated support throughout your property journey - from initial consultation to post-purchase services.
            </p>
        </div>
    </div>
</section>

<!-- Investment Calculator Section -->
<section class="calculators-section">
    <div class="section-title">
        <h2>UAE Property Investment Calculators</h2>
        <p>Make informed decisions with our accurate calculators designed specifically for Dubai real estate
            investments.</p>
    </div>

    <!-- Mortgage Calculator -->
    <div id="mortgage-calculator" class="calculator-container">
        <div class="calculator-card">
            <div class="calculator-header">
                <h3>UAE Mortgage Payment Calculator</h3>
                <p>Calculate your monthly mortgage payments based on current UAE bank rates and regulations.</p>
            </div>
            <div class="calculator-grid">
                <div class="calculator-left">
                    <!-- Primary Result Display -->
                    <!-- <div class="result-display">
                        <div class="result-main">
                            <span class="result-label-small">Monthly payment</span>
                            <div class="result-value-large" id="monthly-payment">4,936 AED</div>
                        </div>
                        <div class="result-secondary">
                            <span class="result-label-small">Interest rate</span>
                            <div class="result-value-medium" id="display-rate">3.75%</div>
                        </div>
                    </div> -->

                    <!-- View Upfront Costs Button -->
                    <!-- <div class="upfront-costs-section">
                    <button class="btn-upfront-costs" id="view-upfront-costs">
                        <i class="fas fa-calculator"></i>
                        View upfront costs & fees
                    </button>
                    </div> -->

                    <!-- Fees Breakdown (Hidden by default) -->
                    <!-- <div class="fees-breakdown" id="fees-breakdown">
                    <h4>One-time Costs & Fees</h4>
                    <div class="fee-item">
                        <span class="fee-label">Down Payment (20%)</span>
                        <span class="fee-value" id="down-payment-fee">240,000 AED</span>
                    </div>
                    <div class="fee-item">
                        <span class="fee-label">Land Department Fee (4%)</span>
                        <span class="fee-value" id="land-dept-fee">48,000 AED</span>
                    </div>
                    <div class="fee-item">
                        <span class="fee-label">DLD Registration</span>
                        <span class="fee-value">4,000 AED</span>
                    </div>
                    <div class="fee-item">
                        <span class="fee-label">Bank Processing Fee</span>
                        <span class="fee-value" id="processing-fee">2,500 AED</span>
                    </div>
                    <div class="fee-item">
                        <span class="fee-label">Property Valuation</span>
                        <span class="fee-value">2,500 AED</span>
                    </div>
                    <div class="fee-item">
                        <span class="fee-label">Legal Fees</span>
                        <span class="fee-value">5,000 AED</span>
                    </div>
                    <div class="fee-item">
                        <span class="fee-label"><strong>Total Upfront Cost</strong></span>
                        <span class="fee-value" id="total-upfront">302,000 AED</span>
                    </div>
                </div> -->

                    <div class="calculator-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="property-price">Property Purchase Price</label>
                                <div class="input-slider-group">
                                    <input type="text" id="property-price-input" value="1,200,000"
                                        class="editable-input">
                                    <input type="range" id="property-price" min="300000" max="200000000" value="1200000"
                                        class="slider">
                                    <div class="slider-values">
                                        <span class="min-value">300,000 AED</span>
                                        <span class="max-value">200,000,000 AED</span>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="residency-status">Residency Status</label>
                                <div class="button-group">
                                    <button type="button" class="status-btn" data-value="uae-national" data-rate="3.25">
                                        UAE National
                                        <span class="rate-badge">3.25%</span>
                                    </button>
                                    <button type="button" class="status-btn active" data-value="uae-resident"
                                        data-rate="3.75">
                                        UAE Resident
                                        <span class="rate-badge">3.75%</span>
                                    </button>
                                    <button type="button" class="status-btn" data-value="non-resident" data-rate="4.54">
                                        Non-Resident
                                        <span class="rate-badge">4.54%</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="down-payment">Down Payment</label>
                                <div class="input-slider-group">
                                    <input type="text" id="down-payment-input" value="240,000" class="editable-input">
                                    <input type="range" id="down-payment" min="240000" max="960000" value="240000"
                                        class="slider">
                                    <div class="slider-values">
                                        <span class="min-value" id="down-min-display">240,000 AED (20%)</span>
                                        <span class="percentage-value" id="down-percentage">20%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="loan-amount">Loan Amount</label>
                                <div class="input-slider-group">
                                    <input type="text" id="loan-amount-input" value="960,000" class="editable-input">
                                    <input type="range" id="loan-amount" min="240000" max="960000" value="960000"
                                        class="slider">
                                    <div class="slider-values">
                                        <span class="min-value" id="loan-min-display">240,000 AED (20%)</span>
                                        <span class="percentage-value" id="loan-percentage">80%</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="loan-period">Loan Period (Years)</label>
                                <div class="input-slider-group">
                                    <input type="text" id="loan-period-input" value="25" class="editable-input">
                                    <input type="range" id="loan-period" min="1" max="25" value="25" step="1"
                                        class="slider">
                                    <div class="slider-values">
                                        <span class="min-value">1 year</span>
                                        <span class="max-value">25 years</span>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="interest-rate">Annual Interest Rate (%)</label>
                                <div class="input-slider-group">
                                    <input type="text" id="interest-rate-input" value="3.75" class="editable-input">
                                    <input type="range" id="interest-rate" min="2.5" max="8" value="3.75"
                                        class="slider">
                                    <div class="slider-values">
                                        <span class="min-value">2.5%</span>
                                        <span class="max-value">8%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
            
            <div class="calculator-right">
                <div class="result-display">
                        <div class="result-main">
                            <span class="result-label-small">Monthly payment</span>
                            <div class="result-value-large" id="monthly-payment">4,936 AED</div>
                        </div>
                        <div class="result-secondary">
                            <span class="result-label-small">Interest rate</span>
                            <div class="result-value-medium" id="display-rate">3.75%</div>
                        </div>
                    </div>
            </div>
            </div>
            </div>
            <!-- ROI Calculator -->
            <div id="roi-calculator" class="calculator-container">
                <div class="calculator-card">
                    <div class="calculator-header">
                        <h3>Dubai Property ROI Calculator</h3>
                        <p>Analyze potential returns on your Dubai property investment with comprehensive ROI
                            calculations.</p>
                    </div>

                    <div class="calculator-grid">
                <div class="calculator-left">

                    <!-- Primary Result Display -->
                    <!-- <div class="result-display">
                        <div class="result-main">
                            <span class="result-label-small">Total ROI</span>
                            <div class="result-value-large" id="total-roi-display">31.20%</div>
                        </div>
                        <div class="result-secondary">
                            <span class="result-label-small">Annual return</span>
                            <div class="result-value-medium" id="annual-roi-display">6.24%</div>
                        </div>
                    </div> -->

                    <div class="calculator-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="purchase-price">Purchase Price (AED)</label>
                                <div class="input-slider-group">
                                    <input type="text" id="purchase-price-input" value="2,500,000"
                                        class="editable-input">
                                    <input type="range" id="purchase-price" min="500000" max="10000000" value="2500000"
                                        class="slider">
                                    <div class="slider-values">
                                        <span class="min-value">500,000 AED</span>
                                        <span class="max-value">10,000,000 AED</span>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="current-value">Current Market Value (AED)</label>
                                <div class="input-slider-group">
                                    <input type="text" id="current-value-input" value="3,000,000"
                                        class="editable-input">
                                    <input type="range" id="current-value" min="500000" max="12000000" value="3000000"
                                        class="slider">
                                    <div class="slider-values">
                                        <span class="min-value">500,000 AED</span>
                                        <span class="max-value">12,000,000 AED</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="annual-rent">Annual Rental Income (AED)</label>
                                <div class="input-slider-group">
                                    <input type="text" id="annual-rent-input" value="180,000" class="editable-input">
                                    <input type="range" id="annual-rent" min="30000" max="800000" value="180000"
                                        class="slider">
                                    <div class="slider-values">
                                        <span class="min-value">30,000 AED</span>
                                        <span class="max-value">800,000 AED</span>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="annual-expenses">Annual Expenses (AED)</label>
                                <div class="input-slider-group">
                                    <input type="text" id="annual-expenses-input" value="25,000" class="editable-input">
                                    <input type="range" id="annual-expenses" min="5000" max="100000" value="25000"
                                        class="slider">
                                    <div class="slider-values">
                                        <span class="min-value">5,000 AED</span>
                                        <span class="max-value">100,000 AED</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="holding-period">Investment Period (Years)</label>
                                <div class="input-slider-group">
                                    <input type="text" id="holding-period-input" value="5" class="editable-input">
                                    <input type="range" id="holding-period" min="1" max="20" value="5" step="1"
                                        class="slider">
                                    <div class="slider-values">
                                        <span class="min-value">1 year</span>
                                        <span class="max-value">20 years</span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <!-- Empty for layout balance -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="calculator-right">
                    <div class="result-display">
                        <div class="result-main">
                            <span class="result-label-small">Total ROI</span>
                            <div class="result-value-large" id="total-roi-display">31.20%</div>
                        </div>
                        <div class="result-secondary">
                            <span class="result-label-small">Annual return</span>
                            <div class="result-value-medium" id="annual-roi-display">6.24%</div>
                        </div>
                    </div>
                </div>
                </div>
            </div>
</section>

<!-- CTA Section -->
<section class="cta-section">
    <div class="cta-content">
        <h2>Ready to Invest in Dubai Real Estate?</h2>
        <p>Join thousands of satisfied investors who chose KIF Realty for their Dubai property investments. Get expert
            guidance on buying apartments, luxury villas, and off-plan properties with guaranteed returns.</p>
        <div class="cta-buttons">
            <a href="/contact" class="btn-primary-custom">Start Your Investment Journey</a>
            <a href="/properties" class="btn-secondary-custom">Browse Properties</a>
        </div>
    </div>
</section>

{% endblock %}

{% block extra_js %}
<script>
    // UAE Property Investment Calculators - Fixed Implementation with Precise Input Handling
    document.addEventListener('DOMContentLoaded', function () {

        // Utility Functions
        function formatNumber(num) {
            return new Intl.NumberFormat('en-AE').format(Math.round(num));
        }

        function formatCurrency(num) {
            return new Intl.NumberFormat('en-AE').format(Math.round(num)) + ' AED';
        }

        function parseFormattedNumber(str) {
            return parseFloat(str.toString().replace(/,/g, ''));
        }

        // MORTGAGE CALCULATOR
        function setupMortgageCalculator() {
            const elements = {
                propertyPrice: document.getElementById('property-price'),
                downPayment: document.getElementById('down-payment'),
                loanAmount: document.getElementById('loan-amount'),
                loanPeriod: document.getElementById('loan-period'),
                interestRate: document.getElementById('interest-rate'),

                propertyPriceInput: document.getElementById('property-price-input'),
                downPaymentInput: document.getElementById('down-payment-input'),
                loanAmountInput: document.getElementById('loan-amount-input'),
                loanPeriodInput: document.getElementById('loan-period-input'),
                interestRateInput: document.getElementById('interest-rate-input'),

                monthlyPayment: document.getElementById('monthly-payment'),
                displayRate: document.getElementById('display-rate'),
                downPercentage: document.getElementById('down-percentage'),
                loanPercentage: document.getElementById('loan-percentage')
            };

            // Store actual values separately from slider values to maintain precision
            let actualValues = {
                propertyPrice: 500000,
                downPayment: 100000,
                loanAmount: 400000,
                loanPeriod: 25,
                interestRate: 3.5
            };

            function updateMortgageCalculations() {
                const price = actualValues.propertyPrice;
                const down = actualValues.downPayment;
                const loan = actualValues.loanAmount;
                const period = actualValues.loanPeriod;
                const rate = actualValues.interestRate;

                // Update input displays with precise values
                elements.propertyPriceInput.value = formatNumber(price);
                elements.downPaymentInput.value = formatNumber(down);
                elements.loanAmountInput.value = formatNumber(loan);
                elements.loanPeriodInput.value = period;
                elements.interestRateInput.value = rate.toFixed(2);

                // Update slider values (these may be less precise due to step constraints)
                elements.propertyPrice.value = price;
                elements.downPayment.value = down;
                elements.loanAmount.value = loan;
                elements.loanPeriod.value = period;
                elements.interestRate.value = rate;

                // Update percentages
                const downPercent = (down / price) * 100;
                const loanPercent = (loan / price) * 100;
                elements.downPercentage.textContent = downPercent.toFixed(1) + '%';
                elements.loanPercentage.textContent = loanPercent.toFixed(1) + '%';

                // Update min/max displays
                const minDown = Math.max(price * 0.20, 60000); // UAE: 20% minimum for expats, 15% for nationals
                const minLoan = price * 0.15;
                document.getElementById('down-min-display').textContent = formatNumber(minDown) + ' AED (' + ((minDown / price) * 100).toFixed(1) + '%)';
                document.getElementById('loan-min-display').textContent = formatNumber(minLoan) + ' AED (' + ((minLoan / price) * 100).toFixed(1) + '%)';

                // Calculate monthly payment using standard amortization formula
                const monthlyRate = rate / 100 / 12;
                const numberOfPayments = period * 12;

                let monthlyPayment = 0;
                if (monthlyRate > 0) {
                    monthlyPayment = loan * (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) /
                        (Math.pow(1 + monthlyRate, numberOfPayments) - 1);
                } else {
                    monthlyPayment = loan / numberOfPayments;
                }

                elements.monthlyPayment.textContent = formatCurrency(monthlyPayment);
                elements.displayRate.textContent = rate.toFixed(2) + '%';

                // Update fees breakdown
                updateFeesBreakdown(price, down);
            }

            function updateFeesBreakdown(price, down) {
                const landDeptFee = price * 0.04; // 4% of property value
                const processingFee = Math.min(2500, price * 0.001); // Typically 0.1% up to 2500 AED
                const totalUpfront = down + landDeptFee + 4000 + processingFee + 2500 + 5000;

                document.getElementById('down-payment-fee').textContent = formatCurrency(down);
                document.getElementById('land-dept-fee').textContent = formatCurrency(landDeptFee);
                document.getElementById('processing-fee').textContent = formatCurrency(processingFee);
                document.getElementById('total-upfront').textContent = formatCurrency(totalUpfront);
            }

            function syncMortgageValues() {
                const price = actualValues.propertyPrice;
                const down = actualValues.downPayment;
                const loan = price - down;

                // Update loan amount to maintain price = down + loan relationship
                actualValues.loanAmount = loan;

                // Set dynamic ranges based on UAE regulations
                const minDown = Math.max(price * 0.15, 60000); // 15% for nationals, 20% for expats
                const maxDown = price * 0.80; // Maximum 80% down payment
                const minLoan = price * 0.20; // Minimum 20% loan
                const maxLoan = price * 0.85; // Maximum 85% LTV for nationals

                // Update slider ranges
                elements.downPayment.min = minDown;
                elements.downPayment.max = maxDown;
                elements.loanAmount.min = minLoan;
                elements.loanAmount.max = maxLoan;

                // Clamp values to valid ranges
                actualValues.downPayment = Math.max(minDown, Math.min(maxDown, actualValues.downPayment));
                actualValues.loanAmount = Math.max(minLoan, Math.min(maxLoan, actualValues.loanAmount));
            }

            // Property price slider
            elements.propertyPrice.addEventListener('input', function () {
                actualValues.propertyPrice = parseFloat(this.value);
                // Adjust down payment to maintain percentage if possible
                const currentPercent = actualValues.downPayment / (actualValues.propertyPrice + actualValues.loanAmount);
                const newDown = Math.max(actualValues.propertyPrice * 0.20, Math.min(actualValues.propertyPrice * 0.80, actualValues.propertyPrice * currentPercent));
                actualValues.downPayment = newDown;
                syncMortgageValues();
                updateMortgageCalculations();
            });

            // Down payment slider
            elements.downPayment.addEventListener('input', function () {
                actualValues.downPayment = parseFloat(this.value);
                syncMortgageValues();
                updateMortgageCalculations();
            });

            // Loan amount slider
            elements.loanAmount.addEventListener('input', function () {
                actualValues.loanAmount = parseFloat(this.value);
                const down = actualValues.propertyPrice - actualValues.loanAmount;
                actualValues.downPayment = down;
                updateMortgageCalculations();
            });

            // Other sliders
            elements.loanPeriod.addEventListener('input', function () {
                actualValues.loanPeriod = parseFloat(this.value);
                updateMortgageCalculations();
            });

            elements.interestRate.addEventListener('input', function () {
                actualValues.interestRate = parseFloat(this.value);
                updateMortgageCalculations();
            });

            // Residency status buttons
            document.querySelectorAll('.status-btn').forEach(button => {
                button.addEventListener('click', function () {
                    document.querySelectorAll('.status-btn').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');

                    actualValues.interestRate = parseFloat(this.getAttribute('data-rate'));
                    updateMortgageCalculations();
                });
            });

            // Input field synchronization with precise value handling
            function setupInputSync(inputElement, valueKey, isInteger = false, min = 0, max = Infinity) {
                if (!inputElement) return;

                inputElement.addEventListener('input', function () {
                    let value = this.value.replace(/,/g, '');
                    if (isInteger) {
                        value = value.replace(/[^0-9]/g, '');
                    } else {
                        value = value.replace(/[^0-9.]/g, '');
                    }

                    const numValue = parseFloat(value);
                    if (!isNaN(numValue) && value !== '') {
                        if (numValue >= min && numValue <= max) {
                            actualValues[valueKey] = numValue;

                            if (valueKey === 'propertyPrice') {
                                syncMortgageValues();
                            } else if (valueKey === 'downPayment') {
                                syncMortgageValues();
                            } else if (valueKey === 'loanAmount') {
                                actualValues.downPayment = actualValues.propertyPrice - numValue;
                            }
                            updateMortgageCalculations();
                        }
                    }
                });

                inputElement.addEventListener('blur', function () {
                    const value = this.value.replace(/,/g, '');
                    if (value === '' || isNaN(parseFloat(value))) {
                        this.value = isInteger ? actualValues[valueKey].toString() : formatNumber(actualValues[valueKey]);
                        return;
                    }

                    const numValue = parseFloat(value);
                    const clampedValue = Math.max(min, Math.min(max, numValue));

                    actualValues[valueKey] = clampedValue;
                    this.value = isInteger ? clampedValue.toString() : formatNumber(clampedValue);

                    if (valueKey === 'propertyPrice') {
                        syncMortgageValues();
                    } else if (valueKey === 'downPayment') {
                        syncMortgageValues();
                    } else if (valueKey === 'loanAmount') {
                        actualValues.downPayment = actualValues.propertyPrice - clampedValue;
                    }
                    updateMortgageCalculations();
                });
            }

            // Setup input synchronization with appropriate limits
            setupInputSync(elements.propertyPriceInput, 'propertyPrice', false, 100000, 200000000);
            setupInputSync(elements.downPaymentInput, 'downPayment', false, 0, 200000000);
            setupInputSync(elements.loanAmountInput, 'loanAmount', false, 0, 200000000);
            setupInputSync(elements.loanPeriodInput, 'loanPeriod', true, 1, 30);
            setupInputSync(elements.interestRateInput, 'interestRate', false, 0, 20);

            // Upfront costs toggle
            const viewUpfrontButton = document.getElementById('view-upfront-costs');
            if (viewUpfrontButton) {
                viewUpfrontButton.addEventListener('click', function () {
                    const breakdown = document.getElementById('fees-breakdown');
                    if (breakdown) {
                        breakdown.classList.toggle('show');
                        this.textContent = breakdown.classList.contains('show') ?
                            'Hide upfront costs' : 'View upfront costs & fees';
                    }
                });
            }

            // Initialize with default values
            syncMortgageValues();
            updateMortgageCalculations();
        }

        // ROI CALCULATOR
        function setupROICalculator() {
            const elements = {
                purchasePrice: document.getElementById('purchase-price'),
                currentValue: document.getElementById('current-value'),
                annualRent: document.getElementById('annual-rent'),
                annualExpenses: document.getElementById('annual-expenses'),
                holdingPeriod: document.getElementById('holding-period'),

                purchasePriceInput: document.getElementById('purchase-price-input'),
                currentValueInput: document.getElementById('current-value-input'),
                annualRentInput: document.getElementById('annual-rent-input'),
                annualExpensesInput: document.getElementById('annual-expenses-input'),
                holdingPeriodInput: document.getElementById('holding-period-input'),

                totalROIDisplay: document.getElementById('total-roi-display'),
                annualROIDisplay: document.getElementById('annual-roi-display')
            };

            // Store actual ROI values
            let actualROIValues = {
                purchasePrice: 500000,
                currentValue: 600000,
                annualRent: 40000,
                annualExpenses: 8000,
                holdingPeriod: 5
            };

            function calculateROI() {
                const purchasePrice = actualROIValues.purchasePrice;
                const currentValue = actualROIValues.currentValue;
                const annualRent = actualROIValues.annualRent;
                const annualExpenses = actualROIValues.annualExpenses;
                const holdingPeriod = actualROIValues.holdingPeriod;

                // Update input displays
                elements.purchasePriceInput.value = formatNumber(purchasePrice);
                elements.currentValueInput.value = formatNumber(currentValue);
                elements.annualRentInput.value = formatNumber(annualRent);
                elements.annualExpensesInput.value = formatNumber(annualExpenses);
                elements.holdingPeriodInput.value = holdingPeriod;

                // Update slider values
                elements.purchasePrice.value = purchasePrice;
                elements.currentValue.value = currentValue;
                elements.annualRent.value = annualRent;
                elements.annualExpenses.value = annualExpenses;
                elements.holdingPeriod.value = holdingPeriod;

                // Calculate capital appreciation
                const capitalAppreciation = currentValue - purchasePrice;

                // Calculate net rental income over holding period
                const netAnnualRent = annualRent - annualExpenses;
                const totalRentalIncome = netAnnualRent * holdingPeriod;

                // Calculate total ROI
                const totalReturn = capitalAppreciation + totalRentalIncome;
                const totalROI = (totalReturn / purchasePrice) * 100;

                // Calculate annualized ROI
                const annualROI = holdingPeriod > 0 ? totalROI / holdingPeriod : 0;

                // Update displays
                if (elements.totalROIDisplay) elements.totalROIDisplay.textContent = totalROI.toFixed(2) + '%';
                if (elements.annualROIDisplay) elements.annualROIDisplay.textContent = annualROI.toFixed(2) + '%';
            }

            // Add event listeners for sliders
            if (elements.purchasePrice) {
                elements.purchasePrice.addEventListener('input', function () {
                    actualROIValues.purchasePrice = parseFloat(this.value);
                    calculateROI();
                });
            }

            if (elements.currentValue) {
                elements.currentValue.addEventListener('input', function () {
                    actualROIValues.currentValue = parseFloat(this.value);
                    calculateROI();
                });
            }

            if (elements.annualRent) {
                elements.annualRent.addEventListener('input', function () {
                    actualROIValues.annualRent = parseFloat(this.value);
                    calculateROI();
                });
            }

            if (elements.annualExpenses) {
                elements.annualExpenses.addEventListener('input', function () {
                    actualROIValues.annualExpenses = parseFloat(this.value);
                    calculateROI();
                });
            }

            if (elements.holdingPeriod) {
                elements.holdingPeriod.addEventListener('input', function () {
                    actualROIValues.holdingPeriod = parseFloat(this.value);
                    calculateROI();
                });
            }

            // Input field synchronization for ROI
            function setupROIInputSync(inputElement, valueKey, isInteger = false, min = 0, max = Infinity) {
                if (!inputElement) return;

                inputElement.addEventListener('input', function () {
                    let value = this.value.replace(/,/g, '');
                    if (isInteger) {
                        value = value.replace(/[^0-9]/g, '');
                    } else {
                        value = value.replace(/[^0-9.]/g, '');
                    }

                    const numValue = parseFloat(value);
                    if (!isNaN(numValue) && value !== '') {
                        if (numValue >= min && numValue <= max) {
                            actualROIValues[valueKey] = numValue;
                            calculateROI();
                        }
                    }
                });

                inputElement.addEventListener('blur', function () {
                    const value = this.value.replace(/,/g, '');
                    if (value === '' || isNaN(parseFloat(value))) {
                        this.value = isInteger ? actualROIValues[valueKey].toString() : formatNumber(actualROIValues[valueKey]);
                        return;
                    }

                    const numValue = parseFloat(value);
                    const clampedValue = Math.max(min, Math.min(max, numValue));

                    actualROIValues[valueKey] = clampedValue;
                    this.value = isInteger ? clampedValue.toString() : formatNumber(clampedValue);
                    calculateROI();
                });
            }

            // Setup ROI input synchronization
            setupROIInputSync(elements.purchasePriceInput, 'purchasePrice', false, 1000, 200000000);
            setupROIInputSync(elements.currentValueInput, 'currentValue', false, 1000, 200000000);
            setupROIInputSync(elements.annualRentInput, 'annualRent', false, 0, 1000000);
            setupROIInputSync(elements.annualExpensesInput, 'annualExpenses', false, 0, 1000000);
            setupROIInputSync(elements.holdingPeriodInput, 'holdingPeriod', true, 1, 50);

            // Initialize
            calculateROI();
        }

        // Initialize both calculators
        setupMortgageCalculator();
        setupROICalculator();
    });
</script>
{% endblock %}