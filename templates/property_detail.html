{% extends 'base.html' %}

{% block title %}{{ property.title.en }} - KIF Realty{% endblock %}

{% load static %}
{% load custom_filters %}

{% block content %}
<style>
    /* :root {
        --obsidian-black: #0A0A0A;
        --charcoal-gray: #1A1A1A;
        --medium-gray: #2A2A2A;
        --light-gray: #3A3A3A;
        --text-light: #FFFFFF;
        --text-muted: rgba(255, 255, 255, 0.8);
        --rose-gold: #E8B4A0;
        --gold-accent: #F4D03F;
        --accent-gradient: linear-gradient(135deg, var(--rose-gold), var(--gold-accent));
        --shadow-dark: rgba(0, 0, 0, 0.6);
    } */

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    /* body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        line-height: 1.6;
        color: var(--text-light);
        background: var(--obsidian-black);
        overflow-x: hidden;
        padding-top: 80px;
    } */

    /* Loading States */
    .loading-skeleton {
        background: linear-gradient(90deg, var(--charcoal-gray) 25%, var(--medium-gray) 50%, var(--charcoal-gray) 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
    }

    @keyframes loading {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }

    .error-state {
        background: rgba(220, 53, 69, 0.1);
        border: 1px solid rgba(220, 53, 69, 0.3);
        color: #ff6b7a;
        padding: 1rem;
        border-radius: 15px;
        text-align: center;
    }

    /* Main Layout */
    .property-layout {
        display: grid;
        grid-template-columns: 1fr 400px;
        min-height: calc(100vh - 80px);
        gap: 0;
        background: var(--obsidian-black);
    }

    /* Left Panel */
    .left-panel {
        display: flex;
        flex-direction: column;
        overflow: hidden;
        background: var(--obsidian-black);
    }

    /* Hero Section */
    .property-hero {
        position: relative;
        height: 500px;
        overflow: hidden;
        background: linear-gradient(135deg, rgba(42, 42, 42, 0.3), var(--obsidian-black));
    }

    .hero-gallery {
        position: relative;
        width: 100%;
        height: 100%;
    }

    .hero-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .gallery-nav {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: linear-gradient(145deg, var(--charcoal-gray), var(--medium-gray));
        backdrop-filter: blur(15px);
        border: 1px solid rgba(232, 180, 160, 0.2);
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 10;
        font-size: 1.1rem;
        color: var(--text-light);
    }

    .gallery-nav:hover {
        background: var(--accent-gradient);
        color: var(--obsidian-black);
        transform: translateY(-50%) scale(1.15);
        box-shadow: 0 15px 35px rgba(232, 180, 160, 0.4);
    }

    .gallery-prev { left: 25px; }
    .gallery-next { right: 25px; }

    .gallery-indicators {
        position: absolute;
        bottom: 25px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 12px;
        z-index: 10;
    }

    .gallery-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.4);
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        border: 2px solid transparent;
    }

    .gallery-indicator.active {
        background: var(--rose-gold);
        transform: scale(1.3);
        box-shadow: 0 0 20px rgba(232, 180, 160, 0.6);
    }

    .hero-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(45deg, rgba(10, 10, 10, 0.7), rgba(26, 26, 26, 0.4));
        padding: 3rem;
        color: var(--text-light);
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .property-title {
        font-family: 'Cormorant Garamond', serif;
        font-size: 3.5rem;
        font-weight: 300;
        margin-bottom: 1rem;
        background: linear-gradient(135deg, var(--text-light), var(--rose-gold));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        line-height: 1.1;
        letter-spacing: -0.02em;
    }

    .property-location {
        font-size: 1.2rem;
        opacity: 0.9;
        margin-bottom: 2rem;
        display: flex;
        align-items: center;
        gap: 0.8rem;
        color: var(--text-muted);
        font-weight: 300;
    }

    .price-badge {
        display: inline-block;
        background: var(--accent-gradient);
        color: var(--obsidian-black);
        padding: 1.5rem 3rem;
        border-radius: 50px;
        font-size: 1.4rem;
        font-weight: 700;
        box-shadow: 0 15px 35px rgba(232, 180, 160, 0.4);
        align-self: flex-start;
        text-transform: uppercase;
        letter-spacing: 0.1em;
    }

    /* Content Container */
    .content-container {
        flex: 1;
        overflow-y: auto;
        background: linear-gradient(135deg, var(--charcoal-gray), var(--obsidian-black));
        padding: 3rem;
    }

    .content-container::-webkit-scrollbar {
        width: 8px;
    }

    .content-container::-webkit-scrollbar-track {
        background: var(--charcoal-gray);
    }

    .content-container::-webkit-scrollbar-thumb {
        background: var(--accent-gradient);
        border-radius: 4px;
    }

    /* Section Styles */
    .section {
        margin-bottom: 4rem;
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
    }

    .section.animate-in {
        opacity: 1;
        transform: translateY(0);
    }

    .section-title {
        font-family: 'Cormorant Garamond', serif;
        font-size: 2.2rem;
        font-weight: 400;
        color: var(--rose-gold);
        margin-bottom: 2.5rem;
        padding-bottom: 1rem;
        position: relative;
        display: flex;
        align-items: center;
        gap: 1rem;
        letter-spacing: -0.01em;
    }

    .section-title::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 80px;
        height: 3px;
        background: var(--accent-gradient);
        border-radius: 2px;
    }

    .section-title i {
        color: var(--rose-gold);
        font-size: 1.5rem;
    }

    .property-description {
        font-size: 1.1rem;
        line-height: 1.8;
        color: var(--text-muted);
        margin-bottom: 3rem;
        font-weight: 300;
    }

    .property-description p {
        margin-bottom: 1.5rem;
    }

    .property-description p:last-child {
        margin-bottom: 0;
    }

    /* Property Stats */
    .property-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        margin-bottom: 3rem;
    }

    .stat-item {
        background: linear-gradient(145deg, var(--charcoal-gray), var(--medium-gray));
        padding: 2.5rem 2rem;
        border-radius: 20px;
        text-align: center;
        border: 1px solid rgba(232, 180, 160, 0.1);
        transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
    }

    .stat-item::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--accent-gradient);
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    .stat-item:hover::before {
        opacity: 0.05;
    }

    .stat-item:hover {
        border-color: rgba(232, 180, 160, 0.3);
        transform: translateY(-10px);
        box-shadow: 0 20px 40px rgba(232, 180, 160, 0.2);
    }

    .stat-icon {
        font-size: 2.5rem;
        color: var(--rose-gold);
        margin-bottom: 1.5rem;
        display: block;
        position: relative;
        z-index: 1;
    }

    .stat-value {
        font-family: 'Cormorant Garamond', serif;
        font-size: 2.5rem;
        font-weight: 600;
        color: var(--text-light);
        margin-bottom: 0.8rem;
        display: block;
        position: relative;
        z-index: 1;
    }

    .stat-label {
        color: var(--text-muted);
        font-size: 1rem;
        font-weight: 300;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        position: relative;
        z-index: 1;
    }

    /* Facilities Grid */
    .facilities-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-bottom: 3rem;
    }

    .facility-item {
        background: linear-gradient(145deg, var(--charcoal-gray), var(--medium-gray));
        padding: 1.8rem 1.5rem;
        border-radius: 15px;
        display: flex;
        align-items: center;
        gap: 1.2rem;
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        font-size: 1rem;
        border: 1px solid rgba(232, 180, 160, 0.1);
        cursor: pointer;
        position: relative;
        overflow: hidden;
        font-weight: 300;
    }

    .facility-item::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--accent-gradient);
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    .facility-item:hover::before {
        opacity: 0.1;
    }

    .facility-item:hover {
        color: var(--text-light);
        transform: translateY(-5px);
        border-color: rgba(232, 180, 160, 0.3);
        box-shadow: 0 15px 30px rgba(232, 180, 160, 0.2);
    }

    .facility-icon {
        font-size: 1.5rem;
        color: var(--rose-gold);
        transition: all 0.4s ease;
        width: 24px;
        text-align: center;
        flex-shrink: 0;
        position: relative;
        z-index: 1;
    }

    .facility-item:hover .facility-icon {
        transform: scale(1.2);
    }

    /* Units Grid */
    .units-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 2rem;
    }

    .unit-card {
        background: linear-gradient(145deg, var(--charcoal-gray), var(--medium-gray));
        border-radius: 20px;
        padding: 2.5rem 2rem;
        border: 1px solid rgba(232, 180, 160, 0.1);
        transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        position: relative;
        overflow: hidden;
    }

    .unit-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--accent-gradient);
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    .unit-card:hover::before {
        opacity: 0.03;
    }

    .unit-card:hover {
        border-color: rgba(232, 180, 160, 0.3);
        transform: translateY(-15px);
        box-shadow: 0 25px 50px rgba(232, 180, 160, 0.2);
    }

    .unit-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        padding-bottom: 1.5rem;
        border-bottom: 1px solid rgba(232, 180, 160, 0.1);
        position: relative;
        z-index: 1;
    }

    .unit-type {
        font-family: 'Cormorant Garamond', serif;
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--text-light);
        letter-spacing: -0.01em;
    }

    .unit-price {
        background: var(--accent-gradient);
        color: var(--obsidian-black);
        padding: 1rem 2rem;
        border-radius: 25px;
        font-weight: 700;
        font-size: 1.1rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .unit-details {
        display: grid;
        grid-template-columns: 1fr 1fr auto;
        gap: 1.5rem;
        align-items: center;
        position: relative;
        z-index: 1;
    }

    .unit-detail {
        text-align: center;
        padding: 1.5rem 1rem;
        background: linear-gradient(145deg, var(--medium-gray), var(--light-gray));
        border-radius: 12px;
        transition: all 0.4s ease;
        border: 1px solid rgba(232, 180, 160, 0.05);
    }

    .unit-card:hover .unit-detail {
        background: linear-gradient(145deg, var(--light-gray), rgba(232, 180, 160, 0.1));
        border-color: rgba(232, 180, 160, 0.2);
    }

    .unit-detail-value {
        font-family: 'Cormorant Garamond', serif;
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--rose-gold);
        margin-bottom: 0.5rem;
        display: block;
    }

    .unit-detail-label {
        color: var(--text-muted);
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        font-weight: 300;
    }

    .unit-action {
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        color: var(--rose-gold);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .unit-card:hover .unit-action {
        transform: translateX(10px);
        color: var(--text-light);
    }

    /* Right Sidebar */
    .sidebar {
        background: linear-gradient(180deg, var(--charcoal-gray), var(--medium-gray));
        display: flex;
        flex-direction: column;
        border-left: 1px solid rgba(232, 180, 160, 0.1);
        overflow-y: auto;
    }

    .sidebar::-webkit-scrollbar {
        width: 6px;
    }

    .sidebar::-webkit-scrollbar-track {
        background: var(--charcoal-gray);
    }

    .sidebar::-webkit-scrollbar-thumb {
        background: var(--accent-gradient);
        border-radius: 3px;
    }

    .sidebar-card {
        padding: 2.5rem 2rem;
        border-bottom: 1px solid rgba(232, 180, 160, 0.1);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .sidebar-card:last-child {
        border-bottom: none;
    }

    .sidebar-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--accent-gradient);
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    .sidebar-card:hover::before {
        opacity: 0.02;
    }

    /* Contact Card */
    .contact-card {
        margin-top: 18%;
        text-align: center;
        background: linear-gradient(145deg, rgba(232, 180, 160, 0.05), rgba(244, 208, 63, 0.05));
        position: relative;
    }

    .agent-avatar {
        width: 90px;
        height: 90px;
        border-radius: 50%;
        margin: 0 auto 2rem;
        background: var(--accent-gradient);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2.5rem;
        color: var(--obsidian-black);
        box-shadow: 0 15px 35px rgba(232, 180, 160, 0.3);
        position: relative;
        z-index: 1;
    }

    .agent-name {
        font-family: 'Cormorant Garamond', serif;
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 0.8rem;
        color: var(--text-light);
        position: relative;
        z-index: 1;
    }

    .agent-title {
        color: var(--text-muted);
        margin-bottom: 2rem;
        font-size: 1rem;
        font-weight: 300;
        position: relative;
        z-index: 1;
    }

    .contact-btn {
        background: var(--accent-gradient);
        color: var(--obsidian-black);
        padding: 1.2rem 2.5rem;
        border: none;
        border-radius: 50px;
        font-weight: 700;
        cursor: pointer;
        width: 100%;
        margin-bottom: 1.2rem;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;
        text-decoration: none;
        font-size: 1rem;
        position: relative;
        overflow: hidden;
        z-index: 1;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .contact-btn::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        transition: all 0.4s ease;
        transform: translate(-50%, -50%);
    }

    .contact-btn:hover::before {
        width: 300px;
        height: 300px;
    }

    .contact-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 35px rgba(232, 180, 160, 0.4);
        color: var(--obsidian-black);
    }

    .contact-btn.outline {
        background: transparent;
        color: var(--rose-gold);
        border: 2px solid var(--rose-gold);
    }

    .contact-btn.outline:hover {
        background: var(--rose-gold);
        color: var(--obsidian-black);
    }

    /* Info Cards */
    .info-card-title {
        font-family: 'Cormorant Garamond', serif;
        font-size: 1.4rem;
        font-weight: 600;
        margin-bottom: 2rem;
        color: var(--text-light);
        display: flex;
        align-items: center;
        gap: 0.8rem;
        position: relative;
        z-index: 1;
        letter-spacing: -0.01em;
    }

    .info-card-title i {
        color: var(--rose-gold);
    }

    .plan-details {
        display: grid;
        gap: 1rem;
        position: relative;
        z-index: 1;
    }

    .plan-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem 0;
        border-bottom: 1px solid rgba(232, 180, 160, 0.1);
        font-size: 1rem;
        transition: all 0.3s ease;
        font-weight: 300;
    }

    .plan-item:last-child {
        border-bottom: none;
    }

    .plan-item:hover {
        padding-left: 15px;
        background: rgba(232, 180, 160, 0.03);
        margin: 0 -15px;
        border-radius: 8px;
    }

    .plan-item strong {
        color: var(--rose-gold);
        font-weight: 600;
    }

    /* Payment Plans */
    .payment-plan {
        background: linear-gradient(145deg, var(--medium-gray), var(--light-gray));
        border-radius: 15px;
        padding: 2rem 1.8rem;
        margin-bottom: 2rem;
        border: 1px solid rgba(232, 180, 160, 0.1);
        transition: all 0.4s ease;
        position: relative;
        z-index: 1;
    }

    .payment-plan:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(232, 180, 160, 0.1);
        border-color: rgba(232, 180, 160, 0.2);
    }

    .plan-name {
        font-family: 'Cormorant Garamond', serif;
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        color: var(--obsidian-black);
        text-align: center;
        padding: 1rem;
        background: var(--accent-gradient);
        border-radius: 10px;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    /* Location Section */
    .location-content {
        text-align: center;
        padding: 2.5rem 2rem;
        background: linear-gradient(145deg, var(--medium-gray), var(--light-gray));
        border-radius: 15px;
        border: 1px solid rgba(232, 180, 160, 0.1);
        position: relative;
        z-index: 1;
    }

    .location-icon {
        font-size: 3.5rem;
        color: var(--rose-gold);
        margin-bottom: 1.5rem;
    }

    .location-title {
        font-family: 'Cormorant Garamond', serif;
        color: var(--text-light);
        margin-bottom: 1.5rem;
        font-size: 1.8rem;
        font-weight: 600;
        letter-spacing: -0.01em;
    }

    .location-description {
        color: var(--text-muted);
        line-height: 1.7;
        margin-bottom: 2rem;
        font-weight: 300;
    }

    .location-btn {
        background: var(--accent-gradient);
        color: var(--obsidian-black);
        border: none;
        padding: 1rem 2.5rem;
        border-radius: 50px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.4s ease;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .location-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 30px rgba(232, 180, 160, 0.3);
    }

    /* Quick Actions */
    .quick-actions {
        position: fixed;
        bottom: 25px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--accent-gradient);
        padding: 20px 35px;
        border-radius: 50px;
        display: flex;
        gap: 25px;
        box-shadow: 0 15px 40px rgba(232, 180, 160, 0.4);
        z-index: 1000;
        backdrop-filter: blur(15px);
    }

    .quick-action {
        color: var(--obsidian-black);
        text-decoration: none;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 18px;
        border-radius: 25px;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        font-size: 0.95rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .quick-action:hover {
        background: rgba(255, 255, 255, 0.2);
        color: var(--obsidian-black);
        transform: translateY(-3px);
    }

    /* .navbar {
        position: fixed;
        top: 0;
        width: 100%;
        background: var(--charcoal-gray);
        backdrop-filter: blur(15px);
        padding: 1rem 5%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        z-index: 1000;
        transition: all 0.3s ease;
        box-shadow: 0 2px 30px rgba(0, 0, 0, 0.3);
    }

    .navbar span {
        background: var(--accent-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .navbar.scrolled {
        background: var(--medium-gray);
        backdrop-filter: blur(20px);
        box-shadow: 0 4px 40px rgba(0, 0, 0, 0.4);
        padding: 0.8rem 5%;
    } */

    /* Mobile Responsive Design */
    @media (max-width: 1024px) {
        .property-layout {
            grid-template-columns: 1fr 350px;
        }

        .property-stats {
            grid-template-columns: repeat(2, 1fr);
        }

        .facilities-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 768px) {
        body {
            padding-top: 70px;
        }

        .nav-links {
            background-color: var(--medium-gray);
        }

        .property-layout {
            grid-template-columns: 1fr;
            min-height: calc(100vh - 70px);
        }

        .left-panel {
            order: 1;
        }

        .sidebar {
            order: 2;
            border-left: none;
            border-top: 1px solid rgba(232, 180, 160, 0.1);
        }

        .property-hero {
            height: 350px;
        }

        .hero-overlay {
            padding: 2rem 1rem;
        }

        .property-title {
            font-size: 2.8rem;
        }

        .price-badge {
            font-size: 1.2rem;
            padding: 1.2rem 2.5rem;
        }

        .content-container {
            padding: 2rem;
        }

        .section {
            margin-bottom: 3rem;
        }

        .section-title {
            font-size: 1.8rem;
        }

        .property-stats {
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        .facilities-grid {
            grid-template-columns: 1fr;
        }

        .units-grid {
            grid-template-columns: 1fr;
        }

        .unit-details {
            grid-template-columns: 1fr 1fr 60px;
        }

        .sidebar-card {
            padding: 2rem 1.8rem;
        }

        .quick-actions {
            bottom: 15px;
            padding: 15px 25px;
            gap: 20px;
        }

        .quick-action {
            font-size: 0.9rem;
        }
    }

    @media (max-width: 480px) {
        .property-hero {
            height: 280px;
        }

        .hero-overlay {
            padding: 1.5rem;
        }

        .property-title {
            font-size: 2.2rem;
        }

        .content-container {
            padding: 1.5rem;
        }

        .stat-item {
            padding: 2rem 1.5rem;
        }

        .stat-icon {
            font-size: 2rem;
        }

        .stat-value {
            font-size: 2rem;
        }

        .unit-card {
            padding: 2rem 1.5rem;
        }

        .agent-avatar {
            width: 70px;
            height: 70px;
            font-size: 2rem;
        }
    }

    /* Animation Classes */
    .fade-in {
        animation: fadeIn 0.8s ease-in;
    }

    .slide-up {
        animation: slideUp 0.8s ease-out;
    }

    .bounce-in {
        animation: bounceIn 1s ease-out;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes slideUp {
        from {
            opacity: 0;
            transform: translateY(40px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes bounceIn {
        0% {
            opacity: 0;
            transform: scale(0.3);
        }
        50% {
            opacity: 1;
            transform: scale(1.05);
        }
        70% {
            transform: scale(0.9);
        }
        100% {
            opacity: 1;
            transform: scale(1);
        }
    }

    @keyframes titleGlow {
        from {
            text-shadow: 0 0 20px rgba(232, 180, 160, 0.5);
        }
        to {
            text-shadow: 0 0 30px rgba(232, 180, 160, 0.8), 0 0 40px rgba(244, 208, 63, 0.3);
        }
    }

    /* Print Styles */
    @media print {
        .quick-actions,
        .gallery-nav,
        .gallery-indicators {
            display: none;
        }

        .property-layout {
            grid-template-columns: 1fr;
        }

        .property-hero {
            height: 200px;
        }
    }
</style>

<!-- Main Layout -->
<div class="property-layout" id="propertyLayout">
    <!-- Left Panel -->
    <div class="left-panel">
        <!-- Hero Section -->
        <section class="property-hero">
            <div class="hero-gallery">
                <img id="heroImage" src="{{ property.cover }}" alt="{{ property.title.en }}" class="hero-image">

                {% if property.property_images|length > 0 %}
                <button class="gallery-nav gallery-prev" onclick="changeImage(-1)">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="gallery-nav gallery-next" onclick="changeImage(1)">
                    <i class="fas fa-chevron-right"></i>
                </button>

                <div class="gallery-indicators" id="galleryIndicators">
                    <div class="gallery-indicator active"></div>
                    {% for image in property.property_images %}
                    <div class="gallery-indicator"></div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>

            <div class="hero-overlay">
                <h1 class="property-title">{{ property.title.en }}</h1>
                <div class="property-location">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>{{ property.district.name.en }}, {{ property.city.name.en }}</span>
                </div>
                <div class="price-badge">
                    From {{ property.low_price|floatformat:0|add_commas }} AED
                </div>
            </div>
        </section>

        <!-- Content Container -->
        <div class="content-container">
            <!-- Overview Section -->
            <div class="section fade-in" id="overviewSection">
                <h2 class="section-title">
                    <i class="fas fa-home"></i>
                    About This Property
                </h2>
                <div class="property-description">
                    {{ property.description.en|safe }}
                </div>
            </div>

            <!-- Details Section -->
            <div class="section slide-up" id="detailsSection">
                <h2 class="section-title">
                    <i class="fas fa-info-circle"></i>
                    Property Details
                </h2>
                <div class="property-stats">
                    <div class="stat-item">
                        <i class="stat-icon fas fa-building"></i>
                        <div class="stat-value">{{ property.residential_units }}</div>
                        <div class="stat-label">Units</div>
                    </div>
                    <div class="stat-item">
                        <i class="stat-icon fas fa-calendar"></i>
                        <div class="stat-value">{{ property.delivery_date|date:"Y" }}</div>
                        <div class="stat-label">Delivery</div>
                    </div>
                    <div class="stat-item">
                        <i class="stat-icon fas fa-percentage"></i>
                        <div class="stat-value">{{ property.completion_rate }}%</div>
                        <div class="stat-label">Complete</div>
                    </div>
                    <div class="stat-item">
                        <i class="stat-icon fas fa-expand-arrows-alt"></i>
                        <div class="stat-value">{{ property.min_area|floatformat:0 }}</div>
                        <div class="stat-label">Min sq ft</div>
                    </div>
                </div>
            </div>

            <!-- Amenities Section -->
            {% if property.facilities %}
            <div class="section bounce-in" id="amenitiesSection">
                <h2 class="section-title">
                    <i class="fas fa-star"></i>
                    Amenities & Facilities
                </h2>
                <div class="facilities-grid">
                    {% for facility in property.facilities %}
                    <div class="facility-item">
                        <div class="facility-icon">
                            {% if "Swimming" in facility.name.en or "Pool" in facility.name.en %}
                            <i class="fas fa-swimming-pool"></i>
                            {% elif "Gym" in facility.name.en or "Fitness" in facility.name.en %}
                            <i class="fas fa-dumbbell"></i>
                            {% elif "Garden" in facility.name.en or "Park" in facility.name.en %}
                            <i class="fas fa-leaf"></i>
                            {% elif "BBQ" in facility.name.en %}
                            <i class="fas fa-fire"></i>
                            {% elif "Parking" in facility.name.en or "Garage" in facility.name.en %}
                            <i class="fas fa-car"></i>
                            {% elif "Jogging" in facility.name.en or "Track" in facility.name.en %}
                            <i class="fas fa-running"></i>
                            {% elif "Yoga" in facility.name.en or "Spa" in facility.name.en %}
                            <i class="fas fa-peace"></i>
                            {% elif "Playground" in facility.name.en or "Kids" in facility.name.en %}
                            <i class="fas fa-child"></i>
                            {% elif "Security" in facility.name.en %}
                            <i class="fas fa-shield-alt"></i>
                            {% elif "Business" in facility.name.en %}
                            <i class="fas fa-briefcase"></i>
                            {% elif "Retail" in facility.name.en or "Shop" in facility.name.en %}
                            <i class="fas fa-store"></i>
                            {% else %}
                            <i class="fas fa-star"></i>
                            {% endif %}
                        </div>
                        <span>{{ facility.name.en }}</span>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Units Section -->
            {% if property.grouped_apartments %}
            <div class="section fade-in" id="unitsSection">
                <h2 class="section-title">
                    <i class="fas fa-building"></i>
                    Available Units
                </h2>
                <div class="units-grid">
                    {% for unit in property.grouped_apartments %}
                        <div class="unit-card" onclick="navigateToUnit('{{ property.id }}', '{{ unit.id }}')">
                            <div class="unit-header">
                                <div class="unit-type">
                                    {{ unit.unit_type.en }} - {{ unit.rooms.en }}{% if unit.rooms.en != "Studio" %}BR{% endif %}
                                </div>
                                <div class="unit-price">
                                    {{ unit.min_price|floatformat:0|add_commas }} AED
                                </div>
                            </div>
                            <div class="unit-details">
                                <div class="unit-detail">
                                    <div class="unit-detail-value">{{ unit.min_area|floatformat:0 }}</div>
                                    <div class="unit-detail-label">sq ft</div>
                                </div>
                                <div class="unit-detail">
                                    <div class="unit-detail-value">{{ unit.rooms.en }}</div>
                                    <div class="unit-detail-label">
                                        {% if unit.rooms.en == "Studio" %}
                                            Studio
                                        {% else %}
                                            BR
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="unit-action">
                                    <i class="fas fa-arrow-right"></i>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Location Section -->
            <div class="section slide-up" id="locationSection">
                <h2 class="section-title">
                    <i class="fas fa-map-marker-alt"></i>
                    Location & Nearby
                </h2>
                <div class="location-content">
                    <i class="fas fa-map-marked-alt location-icon"></i>
                    <h3 class="location-title">Prime Location</h3>
                    <p class="location-description">
                        Located in {{ property.district.name.en }}, one of Dubai's most sought-after neighborhoods,
                        this property offers excellent connectivity to major landmarks, business districts, and
                        leisure destinations.
                        Experience the perfect blend of urban convenience and luxurious living.
                    </p>

                    <button onclick="toggleMap()" class="location-btn">
                        <i class="fas fa-map"></i> View on Map
                    </button>

                    <!-- Hidden Map Container -->
                    <div id="mapContainer" style="display:none; height:400px; width:100%; margin-top:20px; border-radius:15px; overflow:hidden; border: 1px solid rgba(232, 180, 160, 0.2);">
                        {% if property.latitude and property.longitude %}
                        <iframe
                            src="https://maps.google.com/maps?q={{ property.latitude }},{{ property.longitude }}&z=15&output=embed"
                            width="100%" height="100%" style="border:0;" allowfullscreen loading="lazy"
                            referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                        {% else %}
                        <iframe
                            src="https://maps.google.com/maps?q={{ property.district.name.en|urlencode }}&z=15&output=embed"
                            width="100%" height="100%" style="border:0;" allowfullscreen loading="lazy"
                            referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Right Sidebar -->
    <div class="sidebar">
        <!-- Contact Card -->
        <div class="sidebar-card contact-card">
            <div class="agent-avatar">
                <i class="fas fa-user"></i>
            </div>
            <h3 class="agent-name">Property Consultant</h3>
            <p class="agent-title">{{ property.developer.name }} Representative</p>

            <a href="tel:+971509647864" class="contact-btn">
                <i class="fas fa-phone"></i>
                Call Now
            </a>
            <a href="https://wa.me/971509647864" class="contact-btn outline" target="_blank">
                <i class="fab fa-whatsapp"></i>
                WhatsApp
            </a>
        </div>

        <!-- Quick Info -->
        <div class="sidebar-card">
            <h3 class="info-card-title">
                <i class="fas fa-info-circle"></i>
                Quick Info
            </h3>
            <div class="plan-details">
                <div class="plan-item">
                    <span>Type</span>
                    <strong>Residential</strong>
                </div>
                <div class="plan-item">
                    <span>Developer</span>
                    <strong>{{ property.developer.name }}</strong>
                </div>
                <div class="plan-item">
                    <span>Status</span>
                    <strong>{{ property.sales_status.name.en }}</strong>
                </div>
                <div class="plan-item">
                    <span>Handover</span>
                    <strong>{{ property.delivery_date|date:"M Y" }}</strong>
                </div>
                {% if property.min_area and property.max_area %}
                <div class="plan-item">
                    <span>Built-up Area</span>
                    <strong>{{ property.min_area|floatformat:0 }} - {{ property.max_area|floatformat:0 }} sq ft</strong>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Payment Plans -->
        <div class="sidebar-card">
            <h3 class="info-card-title">
                <i class="fas fa-credit-card"></i>
                Payment Plans
            </h3>
            {% if property.payment_plans %}
            {% for plan in property.payment_plans %}
            <div class="payment-plan">
                <div class="plan-name">{{ plan.name.en }}</div>
                <div class="plan-details">
                    {% for value in plan.values %}
                    <div class="plan-item">
                        <span>{{ value.values.en }}</span>
                        <strong>{{ value.value }}</strong>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div class="payment-plan">
                <div class="plan-name">Standard Plan</div>
                <div class="plan-details">
                    <div class="plan-item">
                        <span>Down Payment</span>
                        <strong>20%</strong>
                    </div>
                    <div class="plan-item">
                        <span>During Construction</span>
                        <strong>60%</strong>
                    </div>
                    <div class="plan-item">
                        <span>On Handover</span>
                        <strong>20%</strong>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>

        <!-- Location Highlights -->
        <div class="sidebar-card">
            <h3 class="info-card-title">
                <i class="fas fa-map"></i>
                Location Highlights
            </h3>
            <div class="plan-details">
                <div class="plan-item">
                    <span>Dubai Mall</span>
                    <strong>15 min</strong>
                </div>
                <div class="plan-item">
                    <span>Burj Khalifa</span>
                    <strong>12 min</strong>
                </div>
                <div class="plan-item">
                    <span>Dubai Airport</span>
                    <strong>25 min</strong>
                </div>
                <div class="plan-item">
                    <span>Beach Access</span>
                    <strong>5 min walk</strong>
                </div>
                <div class="plan-item">
                    <span>Metro Station</span>
                    <strong>8 min walk</strong>
                </div>
            </div>
        </div>

        <!-- Developer Info -->
        <div class="sidebar-card">
            <h3 class="info-card-title">
                <i class="fas fa-building"></i>
                Developer
            </h3>
            <div style="text-align: center; position: relative; z-index: 1;">
                <h4 style="color: var(--rose-gold); margin-bottom: 1rem; font-family: 'Cormorant Garamond', serif; font-size: 1.3rem; font-weight: 600;">{{ property.developer.name }}</h4>
                <p style="color: var(--text-muted); font-size: 1rem; line-height: 1.6; font-weight: 300;">
                    {% if property.developer.description %}
                    {{ property.developer.description }}
                    {% else %}
                    Trusted developer with years of experience in creating exceptional properties in Dubai's prime
                    locations.
                    {% endif %}
                </p>
            </div>
        </div>
    </div>
</div>

<script>
    function toggleMap() {
        const mapContainer = document.getElementById("mapContainer");
        const btn = event.target;
        
        if (mapContainer.style.display === "none" || mapContainer.style.display === "") {
            mapContainer.style.display = "block";
            btn.innerHTML = '<i class="fas fa-times"></i> Hide Map';
        } else {
            mapContainer.style.display = "none";
            btn.innerHTML = '<i class="fas fa-map"></i> View on Map';
        }
    }

    // Image gallery functionality
    let currentImageIndex = 0;
    const images = [
        "{{ property.cover }}"{% for image in property.property_images %},
    "{{ image.image }}"
    {% endfor %}
];

    function changeImage(direction) {
        if (images.length <= 1) return;

        const heroImage = document.getElementById('heroImage');
        const indicators = document.querySelectorAll('.gallery-indicator');

        currentImageIndex += direction;

        if (currentImageIndex >= images.length) currentImageIndex = 0;
        else if (currentImageIndex < 0) currentImageIndex = images.length - 1;

        // Update image with smooth transition
        heroImage.style.opacity = '0.7';
        heroImage.style.transform = 'scale(1.05)';

        setTimeout(() => {
            heroImage.src = images[currentImageIndex];
            heroImage.style.opacity = '1';
            heroImage.style.transform = 'scale(1)';
        }, 300);

        // Update indicators
        indicators.forEach((indicator, index) => {
            indicator.classList.toggle('active', index === currentImageIndex);
        });

        // Reset autoplay
        resetGalleryAutoplay();
    }

    // Auto-play gallery
    let galleryInterval;
    function startGalleryAutoplay() {
        if (images.length > 1) {
            galleryInterval = setInterval(() => {
                changeImage(1);
            }, 5000);
        }
    }

    function resetGalleryAutoplay() {
        clearInterval(galleryInterval);
        startGalleryAutoplay();
    }

    // Navigate to unit page
    function navigateToUnit(propertyId, unitId) {
        window.location.href = `/property/${propertyId}/unit/${unitId}/`;
    }

    // Event Handlers
    function requestBrochure() {
        const btn = event.target.closest('.quick-action');
        const originalHTML = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';

        setTimeout(() => {
            btn.innerHTML = '<i class="fas fa-check"></i> Sent!';
            setTimeout(() => {
                btn.innerHTML = originalHTML;
            }, 2000);
        }, 1500);
    }

    function scheduleViewing() {
        const btn = event.target.closest('.quick-action');
        const originalHTML = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Booking...';

        setTimeout(() => {
            btn.innerHTML = '<i class="fas fa-check"></i> Booked!';
            setTimeout(() => {
                btn.innerHTML = originalHTML;
            }, 2000);
        }, 1500);
    }

    // Initialize animations
    function initializeAnimations() {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-in');
                }
            });
        }, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });

        document.querySelectorAll('.section').forEach(section => {
            observer.observe(section);
        });
    }

    // Touch gestures for mobile
    function initializeTouchGestures() {
        if (!('ontouchstart' in window)) return;

        let startX = 0;
        let startTime = 0;

        const heroGallery = document.querySelector('.hero-gallery');

        heroGallery.addEventListener('touchstart', function (e) {
            startX = e.touches[0].clientX;
            startTime = Date.now();
        }, { passive: true });

        heroGallery.addEventListener('touchend', function (e) {
            const endX = e.changedTouches[0].clientX;
            const timeDiff = Date.now() - startTime;
            const distance = Math.abs(startX - endX);

            if (timeDiff < 500 && distance > 50) {
                if (startX - endX > 0) {
                    changeImage(1); // Swipe left - next image
                } else {
                    changeImage(-1); // Swipe right - previous image
                }
            }
        }, { passive: true });
    }

    // Initialize everything when DOM is loaded
    document.addEventListener('DOMContentLoaded', function () {
        console.log('Initializing property page with obsidian theme...');

        // Initialize all components
        initializeAnimations();
        initializeTouchGestures();

        // Start gallery autoplay if there are multiple images
        if (images.length > 1) {
            startGalleryAutoplay();
        }

        // Stagger loading animations for sections
        const sections = document.querySelectorAll('.section');
        sections.forEach((section, index) => {
            setTimeout(() => {
                section.classList.add('animate-in');
            }, index * 300);
        });

        // Preload images for smooth gallery transitions
        if (images.length > 1) {
            images.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        }

        console.log('Property page initialization complete');
    });

    // Handle page visibility for performance
    document.addEventListener('visibilitychange', function () {
        if (document.hidden) {
            clearInterval(galleryInterval);
        } else {
            if (images.length > 1) {
                startGalleryAutoplay();
            }
        }
    });

    // Keyboard navigation
    document.addEventListener('keydown', function (e) {
        if (e.key === 'ArrowLeft' && images.length > 1) {
            changeImage(-1);
        } else if (e.key === 'ArrowRight' && images.length > 1) {
            changeImage(1);
        }
    });

    // Error handling for images
    document.getElementById('heroImage').addEventListener('error', function () {
        this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAwIiBoZWlnaHQ9IjYwMCIgdmlld0JveD0iMCAwIDgwMCA2MDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI4MDAiIGhlaWdodD0iNjAwIiBmaWxsPSIjMWExYTFhIi8+CjxyZWN0IHg9IjM1MCIgeT0iMjUwIiB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2U4YjRhMCIgcng9IjUwIi8+CjwvU3ZnPgo=';
    });

    // Prevent image context menu
    document.getElementById('heroImage').addEventListener('contextmenu', function (e) {
        e.preventDefault();
    });
</script>

{% endblock %}